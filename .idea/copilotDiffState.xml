<?xml version="1.0" encoding="UTF-8"?>
<project version="4">
  <component name="CopilotDiffPersistence">
    <option name="pendingDiffs">
      <map>
        <entry key="$PROJECT_DIR$/app/src/main/java/com/example/da/database/DatabaseHelper.kt">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/java/com/example/da/database/DatabaseHelper.kt" />
              <option name="originalContent" value="package com.example.da.database&#10;&#10;import android.annotation.SuppressLint&#10;import android.content.ContentValues&#10;import android.content.Context&#10;import android.database.sqlite.SQLiteDatabase&#10;import android.database.sqlite.SQLiteOpenHelper&#10;import com.example.da.model.Answer&#10;import com.example.da.model.Question&#10;import com.example.da.model.Subject&#10;import com.example.da.model.Test&#10;import com.example.da.model.TestResult&#10;&#10;class DatabaseHelper(context: Context) : SQLiteOpenHelper(context, DATABASE_NAME, null, DATABASE_VERSION) {&#10;&#10;    companion object {&#10;        private const val DATABASE_NAME = &quot;QuizApp.db&quot;&#10;        private const val DATABASE_VERSION = 5 // Incremented to trigger onUpgrade&#10;&#10;        // Table Subjects&#10;        private const val TABLE_SUBJECTS = &quot;subjects&quot;&#10;        private const val COLUMN_ID = &quot;id&quot;&#10;        private const val COLUMN_NAME = &quot;name&quot;&#10;        private const val COLUMN_CREATED_AT = &quot;created_at&quot;&#10;&#10;        // Table Questions&#10;        private const val TABLE_QUESTIONS = &quot;questions&quot;&#10;        private const val COLUMN_QUESTION_ID = &quot;question_id&quot;&#10;        private const val COLUMN_SUBJECT_ID = &quot;subject_id&quot;&#10;        private const val COLUMN_QUESTION_TEXT = &quot;question_text&quot;&#10;        private const val COLUMN_DIFFICULTY = &quot;difficulty&quot;&#10;        private const val COLUMN_IS_MULTIPLE_CHOICE = &quot;is_multiple_choice&quot;&#10;&#10;        // Table Answers&#10;        private const val TABLE_ANSWERS = &quot;answers&quot;&#10;        private const val COLUMN_ANSWER_ID = &quot;answer_id&quot;&#10;        private const val COLUMN_ANSWER_QUESTION_ID = &quot;question_id&quot;&#10;        private const val COLUMN_ANSWER_TEXT = &quot;answer_text&quot;&#10;        private const val COLUMN_IS_CORRECT = &quot;is_correct&quot;&#10;&#10;        // Table Tests&#10;        private const val TABLE_TESTS = &quot;tests&quot;&#10;        private const val COLUMN_TEST_ID = &quot;test_id&quot;&#10;        private const val COLUMN_TEST_SUBJECT_ID = &quot;subject_id&quot;&#10;        private const val COLUMN_TEST_NAME = &quot;name&quot;&#10;        private const val COLUMN_NUM_QUESTIONS = &quot;num_questions&quot;&#10;        private const val COLUMN_DURATION_MINUTES = &quot;duration_minutes&quot;&#10;        private const val COLUMN_ALLOW_MULTIPLE_ANSWERS = &quot;allow_multiple_answers&quot;&#10;        private const val COLUMN_EASY_PERCENT = &quot;easy_percent&quot;&#10;        private const val COLUMN_MEDIUM_PERCENT = &quot;medium_percent&quot;&#10;        private const val COLUMN_HARD_PERCENT = &quot;hard_percent&quot;&#10;        private const val COLUMN_TEST_CREATED_AT = &quot;created_at&quot;&#10;&#10;        // Table TestResults&#10;        private const val TABLE_TEST_RESULTS = &quot;test_results&quot;&#10;        private const val COLUMN_RESULT_ID = &quot;result_id&quot;&#10;        private const val COLUMN_RESULT_TEST_ID = &quot;test_id&quot;&#10;        private const val COLUMN_SCORE = &quot;score&quot;&#10;        private const val COLUMN_TIME_TAKEN_SECONDS = &quot;time_taken_seconds&quot;&#10;        private const val COLUMN_RESULT_CREATED_AT = &quot;created_at&quot;&#10;    }&#10;&#10;    override fun onCreate(db: SQLiteDatabase?) {&#10;        val createSubjectsTable = &quot;&quot;&quot;&#10;            CREATE TABLE $TABLE_SUBJECTS (&#10;                $COLUMN_ID INTEGER PRIMARY KEY AUTOINCREMENT,&#10;                $COLUMN_NAME TEXT NOT NULL UNIQUE,&#10;                $COLUMN_CREATED_AT INTEGER NOT NULL&#10;            )&#10;        &quot;&quot;&quot;.trimIndent()&#10;&#10;        val createQuestionsTable = &quot;&quot;&quot;&#10;            CREATE TABLE $TABLE_QUESTIONS (&#10;                $COLUMN_QUESTION_ID INTEGER PRIMARY KEY AUTOINCREMENT,&#10;                $COLUMN_SUBJECT_ID INTEGER NOT NULL,&#10;                $COLUMN_QUESTION_TEXT TEXT NOT NULL,&#10;                $COLUMN_DIFFICULTY TEXT NOT NULL,&#10;                $COLUMN_IS_MULTIPLE_CHOICE INTEGER NOT NULL,&#10;                FOREIGN KEY($COLUMN_SUBJECT_ID) REFERENCES $TABLE_SUBJECTS($COLUMN_ID)&#10;            )&#10;        &quot;&quot;&quot;.trimIndent()&#10;&#10;        val createAnswersTable = &quot;&quot;&quot;&#10;            CREATE TABLE $TABLE_ANSWERS (&#10;                $COLUMN_ANSWER_ID INTEGER PRIMARY KEY AUTOINCREMENT,&#10;                $COLUMN_ANSWER_QUESTION_ID INTEGER NOT NULL,&#10;                $COLUMN_ANSWER_TEXT TEXT NOT NULL,&#10;                $COLUMN_IS_CORRECT INTEGER NOT NULL,&#10;                FOREIGN KEY($COLUMN_ANSWER_QUESTION_ID) REFERENCES $TABLE_QUESTIONS($COLUMN_QUESTION_ID)&#10;            )&#10;        &quot;&quot;&quot;.trimIndent()&#10;&#10;        val createTestsTable = &quot;&quot;&quot;&#10;            CREATE TABLE $TABLE_TESTS (&#10;                $COLUMN_TEST_ID INTEGER PRIMARY KEY AUTOINCREMENT,&#10;                $COLUMN_TEST_SUBJECT_ID INTEGER NOT NULL,&#10;                $COLUMN_TEST_NAME TEXT NOT NULL,&#10;                $COLUMN_NUM_QUESTIONS INTEGER NOT NULL,&#10;                $COLUMN_DURATION_MINUTES INTEGER NOT NULL,&#10;                $COLUMN_ALLOW_MULTIPLE_ANSWERS INTEGER NOT NULL,&#10;                $COLUMN_EASY_PERCENT INTEGER NOT NULL,&#10;                $COLUMN_MEDIUM_PERCENT INTEGER NOT NULL,&#10;                $COLUMN_HARD_PERCENT INTEGER NOT NULL,&#10;                $COLUMN_TEST_CREATED_AT INTEGER NOT NULL,&#10;                FOREIGN KEY($COLUMN_TEST_SUBJECT_ID) REFERENCES $TABLE_SUBJECTS($COLUMN_ID)&#10;            )&#10;        &quot;&quot;&quot;.trimIndent()&#10;&#10;        val createTestResultsTable = &quot;&quot;&quot;&#10;            CREATE TABLE $TABLE_TEST_RESULTS (&#10;                $COLUMN_RESULT_ID INTEGER PRIMARY KEY AUTOINCREMENT,&#10;                $COLUMN_RESULT_TEST_ID INTEGER NOT NULL,&#10;                $COLUMN_SCORE INTEGER NOT NULL,&#10;                $COLUMN_TIME_TAKEN_SECONDS INTEGER NOT NULL,&#10;                $COLUMN_RESULT_CREATED_AT INTEGER NOT NULL,&#10;                FOREIGN KEY($COLUMN_RESULT_TEST_ID) REFERENCES $TABLE_TESTS($COLUMN_TEST_ID)&#10;            )&#10;        &quot;&quot;&quot;.trimIndent()&#10;&#10;        db?.execSQL(createSubjectsTable)&#10;        db?.execSQL(createQuestionsTable)&#10;        db?.execSQL(createAnswersTable)&#10;        db?.execSQL(createTestsTable)&#10;        db?.execSQL(createTestResultsTable)&#10;        addSampleData(db)&#10;    }&#10;&#10;    override fun onUpgrade(db: SQLiteDatabase?, oldVersion: Int, newVersion: Int) {&#10;        db?.execSQL(&quot;DROP TABLE IF EXISTS $TABLE_ANSWERS&quot;)&#10;        db?.execSQL(&quot;DROP TABLE IF EXISTS $TABLE_QUESTIONS&quot;)&#10;        db?.execSQL(&quot;DROP TABLE IF EXISTS $TABLE_TESTS&quot;)&#10;        db?.execSQL(&quot;DROP TABLE IF EXISTS $TABLE_TEST_RESULTS&quot;)&#10;        db?.execSQL(&quot;DROP TABLE IF EXISTS $TABLE_SUBJECTS&quot;)&#10;        onCreate(db)&#10;    }&#10;&#10;    private fun addSampleData(db: SQLiteDatabase?) {&#10;        // Add sample subjects&#10;        val sampleSubjects = listOf(&quot;Toán&quot;, &quot;Vật Lý&quot;, &quot;Hóa Học&quot;, &quot;Tiếng Anh&quot;)&#10;        val subjectIds = mutableListOf&lt;Long&gt;()&#10;        sampleSubjects.forEach { subjectName -&gt;&#10;            val values = ContentValues().apply {&#10;                put(COLUMN_NAME, subjectName)&#10;                put(COLUMN_CREATED_AT, System.currentTimeMillis())&#10;            }&#10;            val id = db?.insert(TABLE_SUBJECTS, null, values)&#10;            id?.let { subjectIds.add(it) }&#10;        }&#10;&#10;        // Add sample tests if subjects were added&#10;        if (subjectIds.isNotEmpty()) {&#10;            val test1 = ContentValues().apply {&#10;                put(COLUMN_TEST_SUBJECT_ID, subjectIds[0]) // Toán&#10;                put(COLUMN_TEST_NAME, &quot;Đề kiểm tra giữa kỳ Toán&quot;)&#10;                put(COLUMN_NUM_QUESTIONS, 15)&#10;                put(COLUMN_DURATION_MINUTES, 45)&#10;                put(COLUMN_ALLOW_MULTIPLE_ANSWERS, 0)&#10;                put(COLUMN_EASY_PERCENT, 40)&#10;                put(COLUMN_MEDIUM_PERCENT, 40)&#10;                put(COLUMN_HARD_PERCENT, 20)&#10;                put(COLUMN_TEST_CREATED_AT, System.currentTimeMillis())&#10;            }&#10;            db?.insert(TABLE_TESTS, null, test1)&#10;&#10;            val test2 = ContentValues().apply {&#10;                put(COLUMN_TEST_SUBJECT_ID, subjectIds[1]) // Vật Lý&#10;                put(COLUMN_TEST_NAME, &quot;Đề thi cuối kỳ Vật Lý&quot;)&#10;                put(COLUMN_NUM_QUESTIONS, 20)&#10;                put(COLUMN_DURATION_MINUTES, 60)&#10;                put(COLUMN_ALLOW_MULTIPLE_ANSWERS, 0)&#10;                put(COLUMN_EASY_PERCENT, 30)&#10;                put(COLUMN_MEDIUM_PERCENT, 50)&#10;                put(COLUMN_HARD_PERCENT, 20)&#10;                put(COLUMN_TEST_CREATED_AT, System.currentTimeMillis())&#10;            }&#10;            db?.insert(TABLE_TESTS, null, test2)&#10;        }&#10;    }&#10;&#10;    fun addSubject(subject: Subject): Long {&#10;        val db = writableDatabase&#10;        val values = ContentValues().apply {&#10;            put(COLUMN_NAME, subject.name)&#10;            put(COLUMN_CREATED_AT, System.currentTimeMillis())&#10;        }&#10;        val id = db.insert(TABLE_SUBJECTS, null, values)&#10;        return id&#10;    }&#10;&#10;    @SuppressLint(&quot;Range&quot;)&#10;    fun getAllSubjects(): List&lt;Subject&gt; {&#10;        val subjects = mutableListOf&lt;Subject&gt;()&#10;        val db = readableDatabase&#10;        val cursor = db.rawQuery(&quot;SELECT * FROM $TABLE_SUBJECTS ORDER BY $COLUMN_CREATED_AT DESC&quot;, null)&#10;        if (cursor.moveToFirst()) {&#10;            do {&#10;                val subject = Subject(&#10;                    id = cursor.getInt(cursor.getColumnIndexOrThrow(COLUMN_ID)),&#10;                    name = cursor.getString(cursor.getColumnIndexOrThrow(COLUMN_NAME)),&#10;                    createdAt = cursor.getLong(cursor.getColumnIndexOrThrow(COLUMN_CREATED_AT))&#10;                )&#10;                subjects.add(subject)&#10;            } while (cursor.moveToNext())&#10;        }&#10;        cursor.close()&#10;        return subjects&#10;    }&#10;&#10;    fun deleteSubject(id: Int): Int {&#10;        val db = writableDatabase&#10;        val result = db.delete(TABLE_SUBJECTS, &quot;$COLUMN_ID = ?&quot;, arrayOf(id.toString()))&#10;        return result&#10;    }&#10;&#10;    fun updateSubject(id: Int, newName: String): Int {&#10;        val db = writableDatabase&#10;        val values = ContentValues().apply {&#10;            put(COLUMN_NAME, newName)&#10;        }&#10;        return db.update(TABLE_SUBJECTS, values, &quot;$COLUMN_ID = ?&quot;, arrayOf(id.toString()))&#10;    }&#10;&#10;    fun deleteSubjectAndQuestions(subjectId: Int) {&#10;        val db = writableDatabase&#10;        db.beginTransaction()&#10;        try {&#10;            // First, delete all questions (and their answers) associated with the subject&#10;            val questions = getQuestionsBySubject(subjectId)&#10;            for (question in questions) {&#10;                deleteQuestion(question.id)&#10;            }&#10;&#10;            // Then, delete the subject itself&#10;            deleteSubject(subjectId)&#10;&#10;            db.setTransactionSuccessful()&#10;        } finally {&#10;            db.endTransaction()&#10;        }&#10;    }&#10;&#10;    @SuppressLint(&quot;Range&quot;)&#10;    fun isSubjectExists(name: String): Boolean {&#10;        val db = readableDatabase&#10;        val query = &quot;SELECT COUNT(*) FROM $TABLE_SUBJECTS WHERE $COLUMN_NAME = ?&quot;&#10;        val cursor = db.rawQuery(query, arrayOf(name))&#10;        var exists = false&#10;        if (cursor.moveToFirst()) {&#10;            exists = cursor.getInt(0) &gt; 0&#10;        }&#10;        cursor.close()&#10;        return exists&#10;    }&#10;&#10;    fun deleteQuestion(questionId: Int): Int {&#10;        val db = writableDatabase&#10;        db.delete(TABLE_ANSWERS, &quot;$COLUMN_ANSWER_QUESTION_ID = ?&quot;, arrayOf(questionId.toString()))&#10;        val result = db.delete(TABLE_QUESTIONS, &quot;$COLUMN_QUESTION_ID = ?&quot;, arrayOf(questionId.toString()))&#10;        return result&#10;    }&#10;&#10;    fun addQuestion(subjectId: Int, questionText: String, difficulty: String, isMultipleChoice: Boolean, answers: List&lt;Pair&lt;String, Boolean&gt;&gt;): Long {&#10;        val db = writableDatabase&#10;        val questionValues = ContentValues().apply {&#10;            put(COLUMN_SUBJECT_ID, subjectId)&#10;            put(COLUMN_QUESTION_TEXT, questionText)&#10;            put(COLUMN_DIFFICULTY, difficulty)&#10;            put(COLUMN_IS_MULTIPLE_CHOICE, if (isMultipleChoice) 1 else 0)&#10;        }&#10;        val questionId = db.insert(TABLE_QUESTIONS, null, questionValues)&#10;&#10;        if (questionId &gt; 0) {&#10;            for ((answerText, isCorrect) in answers) {&#10;                val answerValues = ContentValues().apply {&#10;                    put(COLUMN_ANSWER_QUESTION_ID, questionId)&#10;                    put(COLUMN_ANSWER_TEXT, answerText)&#10;                    put(COLUMN_IS_CORRECT, if (isCorrect) 1 else 0)&#10;                }&#10;                db.insert(TABLE_ANSWERS, null, answerValues)&#10;            }&#10;        }&#10;        return questionId&#10;    }&#10;&#10;    @SuppressLint(&quot;Range&quot;)&#10;    fun getQuestionsBySubject(subjectId: Int): List&lt;Question&gt; {&#10;        val questions = mutableListOf&lt;Question&gt;()&#10;        val db = readableDatabase&#10;        val cursor = db.rawQuery(&quot;SELECT * FROM $TABLE_QUESTIONS WHERE $COLUMN_SUBJECT_ID = ?&quot;, arrayOf(subjectId.toString()))&#10;        if (cursor.moveToFirst()) {&#10;            do {&#10;                val question = Question(&#10;                    id = cursor.getInt(cursor.getColumnIndexOrThrow(COLUMN_QUESTION_ID)),&#10;                    subjectId = cursor.getInt(cursor.getColumnIndexOrThrow(COLUMN_SUBJECT_ID)),&#10;                    text = cursor.getString(cursor.getColumnIndexOrThrow(COLUMN_QUESTION_TEXT)),&#10;                    difficulty = cursor.getString(cursor.getColumnIndexOrThrow(COLUMN_DIFFICULTY)),&#10;                    isMultipleChoice = cursor.getInt(cursor.getColumnIndexOrThrow(COLUMN_IS_MULTIPLE_CHOICE)) == 1&#10;                )&#10;                questions.add(question)&#10;            } while (cursor.moveToNext())&#10;        }&#10;        cursor.close()&#10;        return questions&#10;    }&#10;&#10;    fun addTest(test: Test): Long {&#10;        val db = writableDatabase&#10;        val values = ContentValues().apply {&#10;            put(COLUMN_TEST_SUBJECT_ID, test.subjectId)&#10;            put(COLUMN_TEST_NAME, test.name)&#10;            put(COLUMN_NUM_QUESTIONS, test.numQuestions)&#10;            put(COLUMN_DURATION_MINUTES, test.durationMinutes)&#10;            put(COLUMN_ALLOW_MULTIPLE_ANSWERS, if (test.allowMultipleAnswers) 1 else 0)&#10;            put(COLUMN_EASY_PERCENT, test.easyPercent)&#10;            put(COLUMN_MEDIUM_PERCENT, test.mediumPercent)&#10;            put(COLUMN_HARD_PERCENT, test.hardPercent)&#10;            put(COLUMN_TEST_CREATED_AT, test.createdAt)&#10;        }&#10;        val id = db.insert(TABLE_TESTS, null, values)&#10;        return id&#10;    }&#10;&#10;    @SuppressLint(&quot;Range&quot;)&#10;    fun getAllTests(): List&lt;Test&gt; {&#10;        val tests = mutableListOf&lt;Test&gt;()&#10;        val db = readableDatabase&#10;        val query = &quot;&quot;&quot;&#10;            SELECT t.*, s.$COLUMN_NAME as subject_name&#10;            FROM $TABLE_TESTS t &#10;            JOIN $TABLE_SUBJECTS s ON t.$COLUMN_TEST_SUBJECT_ID = s.$COLUMN_ID &#10;            ORDER BY t.$COLUMN_TEST_CREATED_AT DESC&#10;        &quot;&quot;&quot;.trimIndent()&#10;&#10;        val cursor = db.rawQuery(query, null)&#10;&#10;        if (cursor.moveToFirst()) {&#10;            do {&#10;                val test = Test(&#10;                    testId = cursor.getInt(cursor.getColumnIndexOrThrow(COLUMN_TEST_ID)),&#10;                    subjectId = cursor.getInt(cursor.getColumnIndexOrThrow(COLUMN_TEST_SUBJECT_ID)),&#10;                    name = cursor.getString(cursor.getColumnIndexOrThrow(COLUMN_TEST_NAME)),&#10;                    numQuestions = cursor.getInt(cursor.getColumnIndexOrThrow(COLUMN_NUM_QUESTIONS)),&#10;                    durationMinutes = cursor.getInt(cursor.getColumnIndexOrThrow(COLUMN_DURATION_MINUTES)),&#10;                    allowMultipleAnswers = cursor.getInt(cursor.getColumnIndexOrThrow(COLUMN_ALLOW_MULTIPLE_ANSWERS)) == 1,&#10;                    easyPercent = cursor.getInt(cursor.getColumnIndexOrThrow(COLUMN_EASY_PERCENT)),&#10;                    mediumPercent = cursor.getInt(cursor.getColumnIndexOrThrow(COLUMN_MEDIUM_PERCENT)),&#10;                    hardPercent = cursor.getInt(cursor.getColumnIndexOrThrow(COLUMN_HARD_PERCENT)),&#10;                    createdAt = cursor.getLong(cursor.getColumnIndexOrThrow(COLUMN_TEST_CREATED_AT)),&#10;                    subjectName = cursor.getString(cursor.getColumnIndexOrThrow(&quot;subject_name&quot;))&#10;                )&#10;                tests.add(test)&#10;            } while (cursor.moveToNext())&#10;        }&#10;        cursor.close()&#10;        return tests&#10;    }&#10;&#10;    @SuppressLint(&quot;Range&quot;)&#10;    fun getTestById(testId: Int): Test? {&#10;        val db = readableDatabase&#10;        val query = &quot;&quot;&quot;&#10;            SELECT t.*, s.$COLUMN_NAME as subject_name&#10;            FROM $TABLE_TESTS t &#10;            JOIN $TABLE_SUBJECTS s ON t.$COLUMN_TEST_SUBJECT_ID = s.$COLUMN_ID &#10;            WHERE t.$COLUMN_TEST_ID = ?&#10;        &quot;&quot;&quot;.trimIndent()&#10;        val cursor = db.rawQuery(query, arrayOf(testId.toString()))&#10;        var test: Test? = null&#10;        if (cursor.moveToFirst()) {&#10;            test = Test(&#10;                testId = cursor.getInt(cursor.getColumnIndexOrThrow(COLUMN_TEST_ID)),&#10;                subjectId = cursor.getInt(cursor.getColumnIndexOrThrow(COLUMN_TEST_SUBJECT_ID)),&#10;                name = cursor.getString(cursor.getColumnIndexOrThrow(COLUMN_TEST_NAME)),&#10;                numQuestions = cursor.getInt(cursor.getColumnIndexOrThrow(COLUMN_NUM_QUESTIONS)),&#10;                durationMinutes = cursor.getInt(cursor.getColumnIndexOrThrow(COLUMN_DURATION_MINUTES)),&#10;                allowMultipleAnswers = cursor.getInt(cursor.getColumnIndexOrThrow(COLUMN_ALLOW_MULTIPLE_ANSWERS)) == 1,&#10;                easyPercent = cursor.getInt(cursor.getColumnIndexOrThrow(COLUMN_EASY_PERCENT)),&#10;                mediumPercent = cursor.getInt(cursor.getColumnIndexOrThrow(COLUMN_MEDIUM_PERCENT)),&#10;                hardPercent = cursor.getInt(cursor.getColumnIndexOrThrow(COLUMN_HARD_PERCENT)),&#10;                createdAt = cursor.getLong(cursor.getColumnIndexOrThrow(COLUMN_TEST_CREATED_AT)),&#10;                subjectName = cursor.getString(cursor.getColumnIndexOrThrow(&quot;subject_name&quot;))&#10;            )&#10;        }&#10;        cursor.close()&#10;        return test&#10;    }&#10;&#10;    @SuppressLint(&quot;Range&quot;)&#10;    fun getQuestionsForTest(test: Test): List&lt;Question&gt; {&#10;        val questions = mutableListOf&lt;Question&gt;()&#10;        val db = readableDatabase&#10;&#10;        val numEasy = (test.numQuestions * (test.easyPercent / 100.0)).toInt()&#10;        val numMedium = (test.numQuestions * (test.mediumPercent / 100.0)).toInt()&#10;        val numHard = test.numQuestions - numEasy - numMedium&#10;&#10;        val easyQuestions = getQuestionsByDifficulty(db, test.subjectId, &quot;Dễ&quot;, numEasy)&#10;        val mediumQuestions = getQuestionsByDifficulty(db, test.subjectId, &quot;Trung bình&quot;, numMedium)&#10;        val hardQuestions = getQuestionsByDifficulty(db, test.subjectId, &quot;Khó&quot;, numHard)&#10;&#10;        questions.addAll(easyQuestions)&#10;        questions.addAll(mediumQuestions)&#10;        questions.addAll(hardQuestions)&#10;&#10;        return questions.shuffled()&#10;    }&#10;&#10;    @SuppressLint(&quot;Range&quot;)&#10;    private fun getQuestionsByDifficulty(db: SQLiteDatabase, subjectId: Int, difficulty: String, limit: Int): List&lt;Question&gt; {&#10;        val questions = mutableListOf&lt;Question&gt;()&#10;        val query = &quot;SELECT * FROM $TABLE_QUESTIONS WHERE $COLUMN_SUBJECT_ID = ? AND $COLUMN_DIFFICULTY = ? ORDER BY RANDOM() LIMIT ?&quot;&#10;        val cursor = db.rawQuery(query, arrayOf(subjectId.toString(), difficulty, limit.toString()))&#10;        if (cursor.moveToFirst()) {&#10;            do {&#10;                val question = Question(&#10;                    id = cursor.getInt(cursor.getColumnIndexOrThrow(COLUMN_QUESTION_ID)),&#10;                    subjectId = cursor.getInt(cursor.getColumnIndexOrThrow(COLUMN_SUBJECT_ID)),&#10;                    text = cursor.getString(cursor.getColumnIndexOrThrow(COLUMN_QUESTION_TEXT)),&#10;                    difficulty = cursor.getString(cursor.getColumnIndexOrThrow(COLUMN_DIFFICULTY)),&#10;                    isMultipleChoice = cursor.getInt(cursor.getColumnIndexOrThrow(COLUMN_IS_MULTIPLE_CHOICE)) == 1&#10;                )&#10;                questions.add(question)&#10;            } while (cursor.moveToNext())&#10;        }&#10;        cursor.close()&#10;        return questions&#10;    }&#10;&#10;    @SuppressLint(&quot;Range&quot;)&#10;    fun getAnswersByQuestion(questionId: Int): List&lt;Answer&gt; {&#10;        val answers = mutableListOf&lt;Answer&gt;()&#10;        val db = readableDatabase&#10;        val cursor = db.rawQuery(&quot;SELECT * FROM $TABLE_ANSWERS WHERE $COLUMN_ANSWER_QUESTION_ID = ?&quot;, arrayOf(questionId.toString()))&#10;        if (cursor.moveToFirst()) {&#10;            do {&#10;                val answer = Answer(&#10;                    id = cursor.getInt(cursor.getColumnIndexOrThrow(COLUMN_ANSWER_ID)),&#10;                    questionId = cursor.getInt(cursor.getColumnIndexOrThrow(COLUMN_ANSWER_QUESTION_ID)),&#10;                    answerText = cursor.getString(cursor.getColumnIndexOrThrow(COLUMN_ANSWER_TEXT)),&#10;                    isCorrect = cursor.getInt(cursor.getColumnIndexOrThrow(COLUMN_IS_CORRECT)) == 1&#10;                )&#10;                answers.add(answer)&#10;            } while (cursor.moveToNext())&#10;        }&#10;        cursor.close()&#10;        return answers&#10;    }&#10;&#10;    fun addTestResult(testResult: TestResult): Long {&#10;        val db = writableDatabase&#10;        val values = ContentValues().apply {&#10;            put(COLUMN_RESULT_TEST_ID, testResult.testId)&#10;            put(COLUMN_SCORE, testResult.score)&#10;            put(COLUMN_TIME_TAKEN_SECONDS, testResult.timeTakenSeconds)&#10;            put(COLUMN_RESULT_CREATED_AT, testResult.timestamp)&#10;        }&#10;        val id = db.insert(TABLE_TEST_RESULTS, null, values)&#10;        return id&#10;    }&#10;&#10;    @SuppressLint(&quot;Range&quot;)&#10;    fun getTestResults(testId: Int): List&lt;TestResult&gt; {&#10;        val testResults = mutableListOf&lt;TestResult&gt;()&#10;        val db = readableDatabase&#10;        val cursor = db.rawQuery(&quot;SELECT * FROM $TABLE_TEST_RESULTS WHERE $COLUMN_RESULT_TEST_ID = ? ORDER BY $COLUMN_RESULT_CREATED_AT DESC&quot;, arrayOf(testId.toString()))&#10;        if (cursor.moveToFirst()) {&#10;            do {&#10;                val testResult = TestResult(&#10;                    id = cursor.getInt(cursor.getColumnIndexOrThrow(COLUMN_RESULT_ID)),&#10;                    testId = cursor.getInt(cursor.getColumnIndexOrThrow(COLUMN_RESULT_TEST_ID)),&#10;                    score = cursor.getInt(cursor.getColumnIndexOrThrow(COLUMN_SCORE)),&#10;                    timeTakenSeconds = cursor.getInt(cursor.getColumnIndexOrThrow(COLUMN_TIME_TAKEN_SECONDS)),&#10;                    timestamp = cursor.getLong(cursor.getColumnIndexOrThrow(COLUMN_RESULT_CREATED_AT))&#10;                )&#10;                testResults.add(testResult)&#10;            } while (cursor.moveToNext())&#10;        }&#10;        cursor.close()&#10;        return testResults&#10;    }&#10;}&#10;" />
              <option name="updatedContent" value="package com.example.da.database&#10;&#10;import android.annotation.SuppressLint&#10;import android.content.ContentValues&#10;import android.content.Context&#10;import android.database.sqlite.SQLiteDatabase&#10;import android.database.sqlite.SQLiteOpenHelper&#10;import com.example.da.model.Answer&#10;import com.example.da.model.Question&#10;import com.example.da.model.Subject&#10;import com.example.da.model.Test&#10;import com.example.da.model.TestResult&#10;&#10;class DatabaseHelper(context: Context) : SQLiteOpenHelper(context, DATABASE_NAME, null, DATABASE_VERSION) {&#10;&#10;    companion object {&#10;        private const val DATABASE_NAME = &quot;QuizApp.db&quot;&#10;        private const val DATABASE_VERSION = 5 // Incremented to trigger onUpgrade&#10;&#10;        // Table Subjects&#10;        private const val TABLE_SUBJECTS = &quot;subjects&quot;&#10;        private const val COLUMN_ID = &quot;id&quot;&#10;        private const val COLUMN_NAME = &quot;name&quot;&#10;        private const val COLUMN_CREATED_AT = &quot;created_at&quot;&#10;&#10;        // Table Questions&#10;        private const val TABLE_QUESTIONS = &quot;questions&quot;&#10;        private const val COLUMN_QUESTION_ID = &quot;question_id&quot;&#10;        private const val COLUMN_SUBJECT_ID = &quot;subject_id&quot;&#10;        private const val COLUMN_QUESTION_TEXT = &quot;question_text&quot;&#10;        private const val COLUMN_DIFFICULTY = &quot;difficulty&quot;&#10;        private const val COLUMN_IS_MULTIPLE_CHOICE = &quot;is_multiple_choice&quot;&#10;&#10;        // Table Answers&#10;        private const val TABLE_ANSWERS = &quot;answers&quot;&#10;        private const val COLUMN_ANSWER_ID = &quot;answer_id&quot;&#10;        private const val COLUMN_ANSWER_QUESTION_ID = &quot;question_id&quot;&#10;        private const val COLUMN_ANSWER_TEXT = &quot;answer_text&quot;&#10;        private const val COLUMN_IS_CORRECT = &quot;is_correct&quot;&#10;&#10;        // Table Tests&#10;        private const val TABLE_TESTS = &quot;tests&quot;&#10;        private const val COLUMN_TEST_ID = &quot;test_id&quot;&#10;        private const val COLUMN_TEST_SUBJECT_ID = &quot;subject_id&quot;&#10;        private const val COLUMN_TEST_NAME = &quot;name&quot;&#10;        private const val COLUMN_NUM_QUESTIONS = &quot;num_questions&quot;&#10;        private const val COLUMN_DURATION_MINUTES = &quot;duration_minutes&quot;&#10;        private const val COLUMN_ALLOW_MULTIPLE_ANSWERS = &quot;allow_multiple_answers&quot;&#10;        private const val COLUMN_EASY_PERCENT = &quot;easy_percent&quot;&#10;        private const val COLUMN_MEDIUM_PERCENT = &quot;medium_percent&quot;&#10;        private const val COLUMN_HARD_PERCENT = &quot;hard_percent&quot;&#10;        private const val COLUMN_TEST_CREATED_AT = &quot;created_at&quot;&#10;&#10;        // Table TestResults&#10;        private const val TABLE_TEST_RESULTS = &quot;test_results&quot;&#10;        private const val COLUMN_RESULT_ID = &quot;result_id&quot;&#10;        private const val COLUMN_RESULT_TEST_ID = &quot;test_id&quot;&#10;        private const val COLUMN_SCORE = &quot;score&quot;&#10;        private const val COLUMN_TIME_TAKEN_SECONDS = &quot;time_taken_seconds&quot;&#10;        private const val COLUMN_RESULT_CREATED_AT = &quot;created_at&quot;&#10;    }&#10;&#10;    override fun onCreate(db: SQLiteDatabase?) {&#10;        val createSubjectsTable = &quot;&quot;&quot;&#10;            CREATE TABLE $TABLE_SUBJECTS (&#10;                $COLUMN_ID INTEGER PRIMARY KEY AUTOINCREMENT,&#10;                $COLUMN_NAME TEXT NOT NULL UNIQUE,&#10;                $COLUMN_CREATED_AT INTEGER NOT NULL&#10;            )&#10;        &quot;&quot;&quot;.trimIndent()&#10;&#10;        val createQuestionsTable = &quot;&quot;&quot;&#10;            CREATE TABLE $TABLE_QUESTIONS (&#10;                $COLUMN_QUESTION_ID INTEGER PRIMARY KEY AUTOINCREMENT,&#10;                $COLUMN_SUBJECT_ID INTEGER NOT NULL,&#10;                $COLUMN_QUESTION_TEXT TEXT NOT NULL,&#10;                $COLUMN_DIFFICULTY TEXT NOT NULL,&#10;                $COLUMN_IS_MULTIPLE_CHOICE INTEGER NOT NULL,&#10;                FOREIGN KEY($COLUMN_SUBJECT_ID) REFERENCES $TABLE_SUBJECTS($COLUMN_ID)&#10;            )&#10;        &quot;&quot;&quot;.trimIndent()&#10;&#10;        val createAnswersTable = &quot;&quot;&quot;&#10;            CREATE TABLE $TABLE_ANSWERS (&#10;                $COLUMN_ANSWER_ID INTEGER PRIMARY KEY AUTOINCREMENT,&#10;                $COLUMN_ANSWER_QUESTION_ID INTEGER NOT NULL,&#10;                $COLUMN_ANSWER_TEXT TEXT NOT NULL,&#10;                $COLUMN_IS_CORRECT INTEGER NOT NULL,&#10;                FOREIGN KEY($COLUMN_ANSWER_QUESTION_ID) REFERENCES $TABLE_QUESTIONS($COLUMN_QUESTION_ID)&#10;            )&#10;        &quot;&quot;&quot;.trimIndent()&#10;&#10;        val createTestsTable = &quot;&quot;&quot;&#10;            CREATE TABLE $TABLE_TESTS (&#10;                $COLUMN_TEST_ID INTEGER PRIMARY KEY AUTOINCREMENT,&#10;                $COLUMN_TEST_SUBJECT_ID INTEGER NOT NULL,&#10;                $COLUMN_TEST_NAME TEXT NOT NULL,&#10;                $COLUMN_NUM_QUESTIONS INTEGER NOT NULL,&#10;                $COLUMN_DURATION_MINUTES INTEGER NOT NULL,&#10;                $COLUMN_ALLOW_MULTIPLE_ANSWERS INTEGER NOT NULL,&#10;                $COLUMN_EASY_PERCENT INTEGER NOT NULL,&#10;                $COLUMN_MEDIUM_PERCENT INTEGER NOT NULL,&#10;                $COLUMN_HARD_PERCENT INTEGER NOT NULL,&#10;                $COLUMN_TEST_CREATED_AT INTEGER NOT NULL,&#10;                FOREIGN KEY($COLUMN_TEST_SUBJECT_ID) REFERENCES $TABLE_SUBJECTS($COLUMN_ID)&#10;            )&#10;        &quot;&quot;&quot;.trimIndent()&#10;&#10;        val createTestResultsTable = &quot;&quot;&quot;&#10;            CREATE TABLE $TABLE_TEST_RESULTS (&#10;                $COLUMN_RESULT_ID INTEGER PRIMARY KEY AUTOINCREMENT,&#10;                $COLUMN_RESULT_TEST_ID INTEGER NOT NULL,&#10;                $COLUMN_SCORE INTEGER NOT NULL,&#10;                $COLUMN_TIME_TAKEN_SECONDS INTEGER NOT NULL,&#10;                $COLUMN_RESULT_CREATED_AT INTEGER NOT NULL,&#10;                FOREIGN KEY($COLUMN_RESULT_TEST_ID) REFERENCES $TABLE_TESTS($COLUMN_TEST_ID)&#10;            )&#10;        &quot;&quot;&quot;.trimIndent()&#10;&#10;        db?.execSQL(createSubjectsTable)&#10;        db?.execSQL(createQuestionsTable)&#10;        db?.execSQL(createAnswersTable)&#10;        db?.execSQL(createTestsTable)&#10;        db?.execSQL(createTestResultsTable)&#10;        addSampleData(db)&#10;    }&#10;&#10;    override fun onUpgrade(db: SQLiteDatabase?, oldVersion: Int, newVersion: Int) {&#10;        db?.execSQL(&quot;DROP TABLE IF EXISTS $TABLE_ANSWERS&quot;)&#10;        db?.execSQL(&quot;DROP TABLE IF EXISTS $TABLE_QUESTIONS&quot;)&#10;        db?.execSQL(&quot;DROP TABLE IF EXISTS $TABLE_TESTS&quot;)&#10;        db?.execSQL(&quot;DROP TABLE IF EXISTS $TABLE_TEST_RESULTS&quot;)&#10;        db?.execSQL(&quot;DROP TABLE IF EXISTS $TABLE_SUBJECTS&quot;)&#10;        onCreate(db)&#10;    }&#10;&#10;    private fun addSampleData(db: SQLiteDatabase?) {&#10;        // Add sample subjects&#10;        val sampleSubjects = listOf(&quot;Toán&quot;, &quot;Vật Lý&quot;, &quot;Hóa Học&quot;, &quot;Tiếng Anh&quot;)&#10;        val subjectIds = mutableListOf&lt;Long&gt;()&#10;        sampleSubjects.forEach { subjectName -&gt;&#10;            val values = ContentValues().apply {&#10;                put(COLUMN_NAME, subjectName)&#10;                put(COLUMN_CREATED_AT, System.currentTimeMillis())&#10;            }&#10;            val id = db?.insert(TABLE_SUBJECTS, null, values)&#10;            id?.let { subjectIds.add(it) }&#10;        }&#10;&#10;        // Add sample tests if subjects were added&#10;        if (subjectIds.isNotEmpty()) {&#10;            val test1 = ContentValues().apply {&#10;                put(COLUMN_TEST_SUBJECT_ID, subjectIds[0]) // Toán&#10;                put(COLUMN_TEST_NAME, &quot;Đề kiểm tra giữa kỳ Toán&quot;)&#10;                put(COLUMN_NUM_QUESTIONS, 15)&#10;                put(COLUMN_DURATION_MINUTES, 45)&#10;                put(COLUMN_ALLOW_MULTIPLE_ANSWERS, 0)&#10;                put(COLUMN_EASY_PERCENT, 40)&#10;                put(COLUMN_MEDIUM_PERCENT, 40)&#10;                put(COLUMN_HARD_PERCENT, 20)&#10;                put(COLUMN_TEST_CREATED_AT, System.currentTimeMillis())&#10;            }&#10;            db?.insert(TABLE_TESTS, null, test1)&#10;&#10;            val test2 = ContentValues().apply {&#10;                put(COLUMN_TEST_SUBJECT_ID, subjectIds[1]) // Vật Lý&#10;                put(COLUMN_TEST_NAME, &quot;Đề thi cuối kỳ Vật Lý&quot;)&#10;                put(COLUMN_NUM_QUESTIONS, 20)&#10;                put(COLUMN_DURATION_MINUTES, 60)&#10;                put(COLUMN_ALLOW_MULTIPLE_ANSWERS, 0)&#10;                put(COLUMN_EASY_PERCENT, 30)&#10;                put(COLUMN_MEDIUM_PERCENT, 50)&#10;                put(COLUMN_HARD_PERCENT, 20)&#10;                put(COLUMN_TEST_CREATED_AT, System.currentTimeMillis())&#10;            }&#10;            db?.insert(TABLE_TESTS, null, test2)&#10;        }&#10;    }&#10;&#10;    fun addSubject(subject: Subject): Long {&#10;        val db = writableDatabase&#10;        val values = ContentValues().apply {&#10;            put(COLUMN_NAME, subject.name)&#10;            put(COLUMN_CREATED_AT, System.currentTimeMillis())&#10;        }&#10;        val id = db.insert(TABLE_SUBJECTS, null, values)&#10;        return id&#10;    }&#10;&#10;    @SuppressLint(&quot;Range&quot;)&#10;    fun getAllSubjects(): List&lt;Subject&gt; {&#10;        val subjects = mutableListOf&lt;Subject&gt;()&#10;        val db = readableDatabase&#10;        val cursor = db.rawQuery(&quot;SELECT * FROM $TABLE_SUBJECTS ORDER BY $COLUMN_CREATED_AT DESC&quot;, null)&#10;        if (cursor.moveToFirst()) {&#10;            do {&#10;                val subject = Subject(&#10;                    id = cursor.getInt(cursor.getColumnIndexOrThrow(COLUMN_ID)),&#10;                    name = cursor.getString(cursor.getColumnIndexOrThrow(COLUMN_NAME)),&#10;                    createdAt = cursor.getLong(cursor.getColumnIndexOrThrow(COLUMN_CREATED_AT))&#10;                )&#10;                subjects.add(subject)&#10;            } while (cursor.moveToNext())&#10;        }&#10;        cursor.close()&#10;        return subjects&#10;    }&#10;&#10;    fun deleteSubject(id: Int): Int {&#10;        val db = writableDatabase&#10;        val result = db.delete(TABLE_SUBJECTS, &quot;$COLUMN_ID = ?&quot;, arrayOf(id.toString()))&#10;        return result&#10;    }&#10;&#10;    fun updateSubject(id: Int, newName: String): Int {&#10;        val db = writableDatabase&#10;        val values = ContentValues().apply {&#10;            put(COLUMN_NAME, newName)&#10;        }&#10;        return db.update(TABLE_SUBJECTS, values, &quot;$COLUMN_ID = ?&quot;, arrayOf(id.toString()))&#10;    }&#10;&#10;    fun deleteSubjectAndQuestions(subjectId: Int) {&#10;        val db = writableDatabase&#10;        db.beginTransaction()&#10;        try {&#10;            // First, delete all questions (and their answers) associated with the subject&#10;            val questions = getQuestionsBySubject(subjectId)&#10;            for (question in questions) {&#10;                deleteQuestion(question.id)&#10;            }&#10;&#10;            // Then, delete the subject itself&#10;            deleteSubject(subjectId)&#10;&#10;            db.setTransactionSuccessful()&#10;        } finally {&#10;            db.endTransaction()&#10;        }&#10;    }&#10;&#10;    @SuppressLint(&quot;Range&quot;)&#10;    fun isSubjectExists(name: String): Boolean {&#10;        val db = readableDatabase&#10;        val query = &quot;SELECT COUNT(*) FROM $TABLE_SUBJECTS WHERE $COLUMN_NAME = ?&quot;&#10;        val cursor = db.rawQuery(query, arrayOf(name))&#10;        var exists = false&#10;        if (cursor.moveToFirst()) {&#10;            exists = cursor.getInt(0) &gt; 0&#10;        }&#10;        cursor.close()&#10;        return exists&#10;    }&#10;&#10;    fun deleteQuestion(questionId: Int): Int {&#10;        val db = writableDatabase&#10;        db.delete(TABLE_ANSWERS, &quot;$COLUMN_ANSWER_QUESTION_ID = ?&quot;, arrayOf(questionId.toString()))&#10;        val result = db.delete(TABLE_QUESTIONS, &quot;$COLUMN_QUESTION_ID = ?&quot;, arrayOf(questionId.toString()))&#10;        return result&#10;    }&#10;&#10;    fun addQuestion(subjectId: Int, questionText: String, difficulty: String, isMultipleChoice: Boolean, answers: List&lt;Pair&lt;String, Boolean&gt;&gt;): Long {&#10;        val db = writableDatabase&#10;        val questionValues = ContentValues().apply {&#10;            put(COLUMN_SUBJECT_ID, subjectId)&#10;            put(COLUMN_QUESTION_TEXT, questionText)&#10;            put(COLUMN_DIFFICULTY, difficulty)&#10;            put(COLUMN_IS_MULTIPLE_CHOICE, if (isMultipleChoice) 1 else 0)&#10;        }&#10;        val questionId = db.insert(TABLE_QUESTIONS, null, questionValues)&#10;&#10;        if (questionId &gt; 0) {&#10;            for ((answerText, isCorrect) in answers) {&#10;                val answerValues = ContentValues().apply {&#10;                    put(COLUMN_ANSWER_QUESTION_ID, questionId)&#10;                    put(COLUMN_ANSWER_TEXT, answerText)&#10;                    put(COLUMN_IS_CORRECT, if (isCorrect) 1 else 0)&#10;                }&#10;                db.insert(TABLE_ANSWERS, null, answerValues)&#10;            }&#10;        }&#10;        return questionId&#10;    }&#10;&#10;    @SuppressLint(&quot;Range&quot;)&#10;    fun getQuestionsBySubject(subjectId: Int): List&lt;Question&gt; {&#10;        val questions = mutableListOf&lt;Question&gt;()&#10;        val db = readableDatabase&#10;        val cursor = db.rawQuery(&quot;SELECT * FROM $TABLE_QUESTIONS WHERE $COLUMN_SUBJECT_ID = ?&quot;, arrayOf(subjectId.toString()))&#10;        if (cursor.moveToFirst()) {&#10;            do {&#10;                val question = Question(&#10;                    id = cursor.getInt(cursor.getColumnIndexOrThrow(COLUMN_QUESTION_ID)),&#10;                    subjectId = cursor.getInt(cursor.getColumnIndexOrThrow(COLUMN_SUBJECT_ID)),&#10;                    text = cursor.getString(cursor.getColumnIndexOrThrow(COLUMN_QUESTION_TEXT)),&#10;                    difficulty = cursor.getString(cursor.getColumnIndexOrThrow(COLUMN_DIFFICULTY)),&#10;                    isMultipleChoice = cursor.getInt(cursor.getColumnIndexOrThrow(COLUMN_IS_MULTIPLE_CHOICE)) == 1&#10;                )&#10;                questions.add(question)&#10;            } while (cursor.moveToNext())&#10;        }&#10;        cursor.close()&#10;        return questions&#10;    }&#10;&#10;    fun addTest(test: Test): Long {&#10;        val db = writableDatabase&#10;        val values = ContentValues().apply {&#10;            put(COLUMN_TEST_SUBJECT_ID, test.subjectId)&#10;            put(COLUMN_TEST_NAME, test.name)&#10;            put(COLUMN_NUM_QUESTIONS, test.numQuestions)&#10;            put(COLUMN_DURATION_MINUTES, test.durationMinutes)&#10;            put(COLUMN_ALLOW_MULTIPLE_ANSWERS, if (test.allowMultipleAnswers) 1 else 0)&#10;            put(COLUMN_EASY_PERCENT, test.easyPercent)&#10;            put(COLUMN_MEDIUM_PERCENT, test.mediumPercent)&#10;            put(COLUMN_HARD_PERCENT, test.hardPercent)&#10;            put(COLUMN_TEST_CREATED_AT, test.createdAt)&#10;        }&#10;        val id = db.insert(TABLE_TESTS, null, values)&#10;        return id&#10;    }&#10;&#10;    @SuppressLint(&quot;Range&quot;)&#10;    fun getAllTests(): List&lt;Test&gt; {&#10;        val tests = mutableListOf&lt;Test&gt;()&#10;        val db = readableDatabase&#10;        val query = &quot;&quot;&quot;&#10;            SELECT t.*, s.$COLUMN_NAME as subject_name&#10;            FROM $TABLE_TESTS t &#10;            JOIN $TABLE_SUBJECTS s ON t.$COLUMN_TEST_SUBJECT_ID = s.$COLUMN_ID &#10;            ORDER BY t.$COLUMN_TEST_CREATED_AT DESC&#10;        &quot;&quot;&quot;.trimIndent()&#10;&#10;        val cursor = db.rawQuery(query, null)&#10;&#10;        if (cursor.moveToFirst()) {&#10;            do {&#10;                val test = Test(&#10;                    testId = cursor.getInt(cursor.getColumnIndexOrThrow(COLUMN_TEST_ID)),&#10;                    subjectId = cursor.getInt(cursor.getColumnIndexOrThrow(COLUMN_TEST_SUBJECT_ID)),&#10;                    name = cursor.getString(cursor.getColumnIndexOrThrow(COLUMN_TEST_NAME)),&#10;                    numQuestions = cursor.getInt(cursor.getColumnIndexOrThrow(COLUMN_NUM_QUESTIONS)),&#10;                    durationMinutes = cursor.getInt(cursor.getColumnIndexOrThrow(COLUMN_DURATION_MINUTES)),&#10;                    allowMultipleAnswers = cursor.getInt(cursor.getColumnIndexOrThrow(COLUMN_ALLOW_MULTIPLE_ANSWERS)) == 1,&#10;                    easyPercent = cursor.getInt(cursor.getColumnIndexOrThrow(COLUMN_EASY_PERCENT)),&#10;                    mediumPercent = cursor.getInt(cursor.getColumnIndexOrThrow(COLUMN_MEDIUM_PERCENT)),&#10;                    hardPercent = cursor.getInt(cursor.getColumnIndexOrThrow(COLUMN_HARD_PERCENT)),&#10;                    createdAt = cursor.getLong(cursor.getColumnIndexOrThrow(COLUMN_TEST_CREATED_AT)),&#10;                    subjectName = cursor.getString(cursor.getColumnIndexOrThrow(&quot;subject_name&quot;))&#10;                )&#10;                tests.add(test)&#10;            } while (cursor.moveToNext())&#10;        }&#10;        cursor.close()&#10;        return tests&#10;    }&#10;&#10;    @SuppressLint(&quot;Range&quot;)&#10;    fun getTestById(testId: Int): Test? {&#10;        val db = readableDatabase&#10;        val query = &quot;&quot;&quot;&#10;            SELECT t.*, s.$COLUMN_NAME as subject_name&#10;            FROM $TABLE_TESTS t &#10;            JOIN $TABLE_SUBJECTS s ON t.$COLUMN_TEST_SUBJECT_ID = s.$COLUMN_ID &#10;            WHERE t.$COLUMN_TEST_ID = ?&#10;        &quot;&quot;&quot;.trimIndent()&#10;        val cursor = db.rawQuery(query, arrayOf(testId.toString()))&#10;        var test: Test? = null&#10;        if (cursor.moveToFirst()) {&#10;            test = Test(&#10;                testId = cursor.getInt(cursor.getColumnIndexOrThrow(COLUMN_TEST_ID)),&#10;                subjectId = cursor.getInt(cursor.getColumnIndexOrThrow(COLUMN_TEST_SUBJECT_ID)),&#10;                name = cursor.getString(cursor.getColumnIndexOrThrow(COLUMN_TEST_NAME)),&#10;                numQuestions = cursor.getInt(cursor.getColumnIndexOrThrow(COLUMN_NUM_QUESTIONS)),&#10;                durationMinutes = cursor.getInt(cursor.getColumnIndexOrThrow(COLUMN_DURATION_MINUTES)),&#10;                allowMultipleAnswers = cursor.getInt(cursor.getColumnIndexOrThrow(COLUMN_ALLOW_MULTIPLE_ANSWERS)) == 1,&#10;                easyPercent = cursor.getInt(cursor.getColumnIndexOrThrow(COLUMN_EASY_PERCENT)),&#10;                mediumPercent = cursor.getInt(cursor.getColumnIndexOrThrow(COLUMN_MEDIUM_PERCENT)),&#10;                hardPercent = cursor.getInt(cursor.getColumnIndexOrThrow(COLUMN_HARD_PERCENT)),&#10;                createdAt = cursor.getLong(cursor.getColumnIndexOrThrow(COLUMN_TEST_CREATED_AT)),&#10;                subjectName = cursor.getString(cursor.getColumnIndexOrThrow(&quot;subject_name&quot;))&#10;            )&#10;        }&#10;        cursor.close()&#10;        return test&#10;    }&#10;&#10;    // Add delete and update helpers for tests&#10;    fun deleteTest(testId: Int): Int {&#10;        val db = writableDatabase&#10;        val result = db.delete(TABLE_TESTS, &quot;$COLUMN_TEST_ID = ?&quot;, arrayOf(testId.toString()))&#10;        return result&#10;    }&#10;&#10;    fun updateTest(testId: Int, updated: Test): Int {&#10;        val db = writableDatabase&#10;        val values = ContentValues().apply {&#10;            put(COLUMN_TEST_SUBJECT_ID, updated.subjectId)&#10;            put(COLUMN_TEST_NAME, updated.name)&#10;            put(COLUMN_NUM_QUESTIONS, updated.numQuestions)&#10;            put(COLUMN_DURATION_MINUTES, updated.durationMinutes)&#10;            put(COLUMN_ALLOW_MULTIPLE_ANSWERS, if (updated.allowMultipleAnswers) 1 else 0)&#10;            put(COLUMN_EASY_PERCENT, updated.easyPercent)&#10;            put(COLUMN_MEDIUM_PERCENT, updated.mediumPercent)&#10;            put(COLUMN_HARD_PERCENT, updated.hardPercent)&#10;            // Don't touch created_at&#10;        }&#10;        val result = db.update(TABLE_TESTS, values, &quot;$COLUMN_TEST_ID = ?&quot;, arrayOf(testId.toString()))&#10;        return result&#10;    }&#10;&#10;    @SuppressLint(&quot;Range&quot;)&#10;    fun getQuestionsForTest(test: Test): List&lt;Question&gt; {&#10;        val questions = mutableListOf&lt;Question&gt;()&#10;        val db = readableDatabase&#10;&#10;        val numEasy = (test.numQuestions * (test.easyPercent / 100.0)).toInt()&#10;        val numMedium = (test.numQuestions * (test.mediumPercent / 100.0)).toInt()&#10;        val numHard = test.numQuestions - numEasy - numMedium&#10;&#10;        val easyQuestions = getQuestionsByDifficulty(db, test.subjectId, &quot;Dễ&quot;, numEasy)&#10;        val mediumQuestions = getQuestionsByDifficulty(db, test.subjectId, &quot;Trung bình&quot;, numMedium)&#10;        val hardQuestions = getQuestionsByDifficulty(db, test.subjectId, &quot;Khó&quot;, numHard)&#10;&#10;        questions.addAll(easyQuestions)&#10;        questions.addAll(mediumQuestions)&#10;        questions.addAll(hardQuestions)&#10;&#10;        return questions.shuffled()&#10;    }&#10;&#10;    @SuppressLint(&quot;Range&quot;)&#10;    private fun getQuestionsByDifficulty(db: SQLiteDatabase, subjectId: Int, difficulty: String, limit: Int): List&lt;Question&gt; {&#10;        val questions = mutableListOf&lt;Question&gt;()&#10;        val query = &quot;SELECT * FROM $TABLE_QUESTIONS WHERE $COLUMN_SUBJECT_ID = ? AND $COLUMN_DIFFICULTY = ? ORDER BY RANDOM() LIMIT ?&quot;&#10;        val cursor = db.rawQuery(query, arrayOf(subjectId.toString(), difficulty, limit.toString()))&#10;        if (cursor.moveToFirst()) {&#10;            do {&#10;                val question = Question(&#10;                    id = cursor.getInt(cursor.getColumnIndexOrThrow(COLUMN_QUESTION_ID)),&#10;                    subjectId = cursor.getInt(cursor.getColumnIndexOrThrow(COLUMN_SUBJECT_ID)),&#10;                    text = cursor.getString(cursor.getColumnIndexOrThrow(COLUMN_QUESTION_TEXT)),&#10;                    difficulty = cursor.getString(cursor.getColumnIndexOrThrow(COLUMN_DIFFICULTY)),&#10;                    isMultipleChoice = cursor.getInt(cursor.getColumnIndexOrThrow(COLUMN_IS_MULTIPLE_CHOICE)) == 1&#10;                )&#10;                questions.add(question)&#10;            } while (cursor.moveToNext())&#10;        }&#10;        cursor.close()&#10;        return questions&#10;    }&#10;&#10;    @SuppressLint(&quot;Range&quot;)&#10;    fun getAnswersByQuestion(questionId: Int): List&lt;Answer&gt; {&#10;        val answers = mutableListOf&lt;Answer&gt;()&#10;        val db = readableDatabase&#10;        val cursor = db.rawQuery(&quot;SELECT * FROM $TABLE_ANSWERS WHERE $COLUMN_ANSWER_QUESTION_ID = ?&quot;, arrayOf(questionId.toString()))&#10;        if (cursor.moveToFirst()) {&#10;            do {&#10;                val answer = Answer(&#10;                    id = cursor.getInt(cursor.getColumnIndexOrThrow(COLUMN_ANSWER_ID)),&#10;                    questionId = cursor.getInt(cursor.getColumnIndexOrThrow(COLUMN_ANSWER_QUESTION_ID)),&#10;                    answerText = cursor.getString(cursor.getColumnIndexOrThrow(COLUMN_ANSWER_TEXT)),&#10;                    isCorrect = cursor.getInt(cursor.getColumnIndexOrThrow(COLUMN_IS_CORRECT)) == 1&#10;                )&#10;                answers.add(answer)&#10;            } while (cursor.moveToNext())&#10;        }&#10;        cursor.close()&#10;        return answers&#10;    }&#10;&#10;    fun addTestResult(testResult: TestResult): Long {&#10;        val db = writableDatabase&#10;        val values = ContentValues().apply {&#10;            put(COLUMN_RESULT_TEST_ID, testResult.testId)&#10;            put(COLUMN_SCORE, testResult.score)&#10;            put(COLUMN_TIME_TAKEN_SECONDS, testResult.timeTakenSeconds)&#10;            put(COLUMN_RESULT_CREATED_AT, testResult.timestamp)&#10;        }&#10;        val id = db.insert(TABLE_TEST_RESULTS, null, values)&#10;        return id&#10;    }&#10;&#10;    @SuppressLint(&quot;Range&quot;)&#10;    fun getTestResults(testId: Int): List&lt;TestResult&gt; {&#10;        val testResults = mutableListOf&lt;TestResult&gt;()&#10;        val db = readableDatabase&#10;        val cursor = db.rawQuery(&quot;SELECT * FROM $TABLE_TEST_RESULTS WHERE $COLUMN_RESULT_TEST_ID = ? ORDER BY $COLUMN_RESULT_CREATED_AT DESC&quot;, arrayOf(testId.toString()))&#10;        if (cursor.moveToFirst()) {&#10;            do {&#10;                val testResult = TestResult(&#10;                    id = cursor.getInt(cursor.getColumnIndexOrThrow(COLUMN_RESULT_ID)),&#10;                    testId = cursor.getInt(cursor.getColumnIndexOrThrow(COLUMN_RESULT_TEST_ID)),&#10;                    score = cursor.getInt(cursor.getColumnIndexOrThrow(COLUMN_SCORE)),&#10;                    timeTakenSeconds = cursor.getInt(cursor.getColumnIndexOrThrow(COLUMN_TIME_TAKEN_SECONDS)),&#10;                    timestamp = cursor.getLong(cursor.getColumnIndexOrThrow(COLUMN_RESULT_CREATED_AT))&#10;                )&#10;                testResults.add(testResult)&#10;            } while (cursor.moveToNext())&#10;        }&#10;        cursor.close()&#10;        return testResults&#10;    }&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/app/src/main/java/com/example/da/fragment/CreateTestFragment.kt">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/java/com/example/da/fragment/CreateTestFragment.kt" />
              <option name="originalContent" value="package com.example.da.fragment&#10;&#10;import android.os.Bundle&#10;import androidx.fragment.app.Fragment&#10;import android.view.LayoutInflater&#10;import android.view.View&#10;import android.view.ViewGroup&#10;import android.widget.ArrayAdapter&#10;import android.widget.CheckBox&#10;import android.widget.EditText&#10;import android.widget.ImageView&#10;import android.widget.RadioButton&#10;import android.widget.RadioGroup&#10;import android.widget.Spinner&#10;import android.widget.TextView&#10;import android.widget.Toast&#10;import com.example.da.R&#10;import com.example.da.activity.MainActivity&#10;import com.example.da.database.DatabaseHelper&#10;import com.example.da.model.Subject&#10;import com.example.da.model.Test&#10;&#10;class CreateTestFragment : Fragment() {&#10;&#10;    private lateinit var ivBack: ImageView&#10;    private lateinit var tvAdd: TextView&#10;    private lateinit var spinnerSubject: Spinner&#10;    private lateinit var cbEasy: CheckBox&#10;    private lateinit var cbMedium: CheckBox&#10;    private lateinit var cbHard: CheckBox&#10;    private lateinit var etNumberQuestions: EditText&#10;    private lateinit var rgMultipleChoice: RadioGroup&#10;    private lateinit var rbYes: RadioButton&#10;    private lateinit var rbNo: RadioButton&#10;    private lateinit var etMinutes: EditText&#10;    private lateinit var dbHelper: DatabaseHelper&#10;    private lateinit var subjects: List&lt;Subject&gt;&#10;&#10;    override fun onCreateView(&#10;        inflater: LayoutInflater, container: ViewGroup?,&#10;        savedInstanceState: Bundle?&#10;    ): View? {&#10;        return inflater.inflate(R.layout.fragment_create_test, container, false)&#10;    }&#10;&#10;    override fun onViewCreated(view: View, savedInstanceState: Bundle?) {&#10;        super.onViewCreated(view, savedInstanceState)&#10;&#10;        dbHelper = DatabaseHelper(requireContext())&#10;&#10;        // Initialize views&#10;        ivBack = view.findViewById(R.id.ivBack)&#10;        tvAdd = view.findViewById(R.id.tvAdd)&#10;        spinnerSubject = view.findViewById(R.id.spinner_subject)&#10;        cbEasy = view.findViewById(R.id.cb_easy)&#10;        cbMedium = view.findViewById(R.id.cb_medium)&#10;        cbHard = view.findViewById(R.id.cb_hard)&#10;        etNumberQuestions = view.findViewById(R.id.et_number_questions)&#10;        rgMultipleChoice = view.findViewById(R.id.rg_multiple_choice)&#10;        rbYes = view.findViewById(R.id.rb_yes)&#10;        rbNo = view.findViewById(R.id.rb_no)&#10;        etMinutes = view.findViewById(R.id.et_minutes)&#10;&#10;        // Setup subject spinner&#10;        setupSubjectSpinner()&#10;&#10;        // Setup click listeners&#10;        ivBack.setOnClickListener {&#10;            parentFragmentManager.popBackStack()&#10;        }&#10;&#10;        tvAdd.setOnClickListener {&#10;            createTest()&#10;        }&#10;    }&#10;&#10;    override fun onResume() {&#10;        super.onResume()&#10;        (activity as? MainActivity)?.showBottomNavigation(false)&#10;    }&#10;&#10;    override fun onPause() {&#10;        super.onPause()&#10;        (activity as? MainActivity)?.showBottomNavigation(true)&#10;    }&#10;&#10;    private fun setupSubjectSpinner() {&#10;        subjects = dbHelper.getAllSubjects()&#10;        val subjectNames = subjects.map { it.name }&#10;        val adapter = ArrayAdapter(requireContext(), android.R.layout.simple_spinner_item, subjectNames)&#10;        adapter.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item)&#10;        spinnerSubject.adapter = adapter&#10;    }&#10;&#10;    private fun createTest() {&#10;        // Validate inputs&#10;        val selectedSubjectPosition = spinnerSubject.selectedItemPosition&#10;        if (selectedSubjectPosition &lt; 0 || selectedSubjectPosition &gt;= subjects.size) {&#10;            Toast.makeText(requireContext(), &quot;Vui lòng chọn môn học&quot;, Toast.LENGTH_SHORT).show()&#10;            return&#10;        }&#10;        val selectedSubject = subjects[selectedSubjectPosition]&#10;&#10;&#10;        val checkedDifficulties = listOf(cbEasy, cbMedium, cbHard).filter { it.isChecked }&#10;        if (checkedDifficulties.isEmpty()) {&#10;            Toast.makeText(requireContext(), &quot;Vui lòng chọn ít nhất một mức độ&quot;, Toast.LENGTH_SHORT).show()&#10;            return&#10;        }&#10;&#10;        val numQuestionsStr = etNumberQuestions.text.toString()&#10;        if (numQuestionsStr.isEmpty()) {&#10;            etNumberQuestions.error = &quot;Vui lòng nhập số câu hỏi&quot;&#10;            etNumberQuestions.requestFocus()&#10;            return&#10;        }&#10;&#10;        val questionCount = numQuestionsStr.toIntOrNull()&#10;        if (questionCount == null || questionCount &lt;= 0) {&#10;            etNumberQuestions.error = &quot;Số câu hỏi phải là số nguyên dương&quot;&#10;            etNumberQuestions.requestFocus()&#10;            return&#10;        }&#10;&#10;        val minutesStr = etMinutes.text.toString()&#10;        if (minutesStr.isEmpty()) {&#10;            etMinutes.error = &quot;Vui lòng nhập thời gian&quot;&#10;            etMinutes.requestFocus()&#10;            return&#10;        }&#10;&#10;        val minutes = minutesStr.toIntOrNull()&#10;        if (minutes == null || minutes &lt;= 0) {&#10;            etMinutes.error = &quot;Thời gian phải là số nguyên dương&quot;&#10;            etMinutes.requestFocus()&#10;            return&#10;        }&#10;&#10;        val allowMultipleAnswers = rbYes.isChecked&#10;&#10;        // Calculate difficulty percentages&#10;        val totalChecked = checkedDifficulties.size&#10;        val percentPerSelection = 100 / totalChecked&#10;        var easyPercent = 0&#10;        var mediumPercent = 0&#10;        var hardPercent = 0&#10;&#10;        checkedDifficulties.forEach {&#10;            when (it.id) {&#10;                R.id.cb_easy -&gt; easyPercent = percentPerSelection&#10;                R.id.cb_medium -&gt; mediumPercent = percentPerSelection&#10;                R.id.cb_hard -&gt; hardPercent = percentPerSelection&#10;            }&#10;        }&#10;&#10;        // Adjust for rounding errors, give remainder to the first checked box&#10;        val remainder = 100 % totalChecked&#10;        if (remainder &gt; 0 &amp;&amp; checkedDifficulties.isNotEmpty()) {&#10;            when (checkedDifficulties.first().id) {&#10;                R.id.cb_easy -&gt; easyPercent += remainder&#10;                R.id.cb_medium -&gt; mediumPercent += remainder&#10;                R.id.cb_hard -&gt; hardPercent += remainder&#10;            }&#10;        }&#10;&#10;&#10;        val testName = &quot;Đề thi môn ${selectedSubject.name}&quot;&#10;&#10;        val newTest = Test(&#10;            subjectId = selectedSubject.id,&#10;            name = testName,&#10;            numQuestions = questionCount,&#10;            durationMinutes = minutes,&#10;            allowMultipleAnswers = allowMultipleAnswers,&#10;            easyPercent = easyPercent,&#10;            mediumPercent = mediumPercent,&#10;            hardPercent = hardPercent&#10;        )&#10;&#10;        val result = dbHelper.addTest(newTest)&#10;&#10;        if (result != -1L) {&#10;            Toast.makeText(&#10;                requireContext(),&#10;                &quot;Tạo đề thi thành công!&quot;,&#10;                Toast.LENGTH_SHORT&#10;            ).show()&#10;            parentFragmentManager.popBackStack()&#10;        } else {&#10;            Toast.makeText(&#10;                requireContext(),&#10;                &quot;Lỗi khi tạo đề thi&quot;,&#10;                Toast.LENGTH_SHORT&#10;            ).show()&#10;        }&#10;    }&#10;}&#10;" />
              <option name="updatedContent" value="package com.example.da.fragment&#10;&#10;import android.os.Bundle&#10;import androidx.fragment.app.Fragment&#10;import android.view.LayoutInflater&#10;import android.view.View&#10;import android.view.ViewGroup&#10;import android.widget.ArrayAdapter&#10;import android.widget.Button&#10;import android.widget.CheckBox&#10;import android.widget.EditText&#10;import android.widget.ImageView&#10;import android.widget.RadioButton&#10;import android.widget.RadioGroup&#10;import android.widget.Spinner&#10;import android.widget.TextView&#10;import android.widget.Toast&#10;import androidx.appcompat.app.AlertDialog&#10;import androidx.recyclerview.widget.LinearLayoutManager&#10;import androidx.recyclerview.widget.RecyclerView&#10;import com.example.da.R&#10;import com.example.da.activity.MainActivity&#10;import com.example.da.adapter.TestAdapter&#10;import com.example.da.database.DatabaseHelper&#10;import com.example.da.model.Subject&#10;import com.example.da.model.Test&#10;&#10;class CreateTestFragment : Fragment() {&#10;&#10;    private lateinit var ivBack: ImageView&#10;    private lateinit var btnAdd: Button&#10;    private lateinit var btnEdit: Button&#10;    private lateinit var btnDelete: Button&#10;    private lateinit var tvMode: TextView&#10;    private lateinit var etTestName: EditText&#10;    private lateinit var spinnerSubject: Spinner&#10;    private lateinit var cbEasy: CheckBox&#10;    private lateinit var cbMedium: CheckBox&#10;    private lateinit var cbHard: CheckBox&#10;    private lateinit var etNumberQuestions: EditText&#10;    private lateinit var rgMultipleChoice: RadioGroup&#10;    private lateinit var rbYes: RadioButton&#10;    private lateinit var rbNo: RadioButton&#10;    private lateinit var etMinutes: EditText&#10;    private lateinit var rvTests: RecyclerView&#10;&#10;    private lateinit var dbHelper: DatabaseHelper&#10;    private lateinit var subjects: List&lt;Subject&gt;&#10;    private var tests: MutableList&lt;Test&gt; = mutableListOf()&#10;    private var adapter: TestAdapter? = null&#10;    private var currentEditingTest: Test? = null&#10;&#10;    // selection modes&#10;    private var selectionMode: SelectionMode = SelectionMode.NONE&#10;&#10;    private enum class SelectionMode { NONE, EDIT, DELETE }&#10;&#10;    override fun onCreateView(&#10;        inflater: LayoutInflater, container: ViewGroup?,&#10;        savedInstanceState: Bundle?&#10;    ): View? {&#10;        return inflater.inflate(R.layout.fragment_create_test, container, false)&#10;    }&#10;&#10;    override fun onViewCreated(view: View, savedInstanceState: Bundle?) {&#10;        super.onViewCreated(view, savedInstanceState)&#10;&#10;        dbHelper = DatabaseHelper(requireContext())&#10;&#10;        // Init views&#10;        ivBack = view.findViewById(R.id.ivBack)&#10;        btnAdd = view.findViewById(R.id.btnAdd)&#10;        btnEdit = view.findViewById(R.id.btnEdit)&#10;        btnDelete = view.findViewById(R.id.btnDelete)&#10;        tvMode = view.findViewById(R.id.tvMode)&#10;        etTestName = view.findViewById(R.id.et_test_name)&#10;        spinnerSubject = view.findViewById(R.id.spinner_subject)&#10;        cbEasy = view.findViewById(R.id.cb_easy)&#10;        cbMedium = view.findViewById(R.id.cb_medium)&#10;        cbHard = view.findViewById(R.id.cb_hard)&#10;        etNumberQuestions = view.findViewById(R.id.et_number_questions)&#10;        rgMultipleChoice = view.findViewById(R.id.rg_multiple_choice)&#10;        rbYes = view.findViewById(R.id.rb_yes)&#10;        rbNo = view.findViewById(R.id.rb_no)&#10;        etMinutes = view.findViewById(R.id.et_minutes)&#10;        rvTests = view.findViewById(R.id.rvTests)&#10;&#10;        setupSubjectSpinner()&#10;        setupRecycler()&#10;        loadTests()&#10;&#10;        ivBack.setOnClickListener { parentFragmentManager.popBackStack() }&#10;&#10;        btnAdd.setOnClickListener {&#10;            if (currentEditingTest != null) {&#10;                updateTest()&#10;            } else {&#10;                createTest()&#10;            }&#10;        }&#10;&#10;        btnEdit.setOnClickListener {&#10;            if (tests.isEmpty()) {&#10;                Toast.makeText(requireContext(), &quot;Không có đề để sửa&quot;, Toast.LENGTH_SHORT).show()&#10;                return@setOnClickListener&#10;            }&#10;            selectionMode = SelectionMode.EDIT&#10;            tvMode.text = getString(R.string.choose_test_to_edit)&#10;            Toast.makeText(requireContext(), &quot;Chạm vào đề trong danh sách để sửa&quot;, Toast.LENGTH_SHORT).show()&#10;        }&#10;&#10;        btnDelete.setOnClickListener {&#10;            if (tests.isEmpty()) {&#10;                Toast.makeText(requireContext(), &quot;Không có đề để xóa&quot;, Toast.LENGTH_SHORT).show()&#10;                return@setOnClickListener&#10;            }&#10;            selectionMode = SelectionMode.DELETE&#10;            tvMode.text = getString(R.string.choose_test_to_delete)&#10;            Toast.makeText(requireContext(), &quot;Chạm vào đề trong danh sách để xóa&quot;, Toast.LENGTH_SHORT).show()&#10;        }&#10;    }&#10;&#10;    private fun setupSubjectSpinner() {&#10;        subjects = dbHelper.getAllSubjects()&#10;        val subjectNames = subjects.map { it.name }&#10;        val adapter = ArrayAdapter(requireContext(), android.R.layout.simple_spinner_item, subjectNames)&#10;        adapter.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item)&#10;        spinnerSubject.adapter = adapter&#10;    }&#10;&#10;    private fun setupRecycler() {&#10;        adapter = TestAdapter(tests) { test -&gt;&#10;            when (selectionMode) {&#10;                SelectionMode.EDIT -&gt; {&#10;                    populateFormForEditing(test)&#10;                    selectionMode = SelectionMode.NONE&#10;                    tvMode.text = getString(R.string.mode_create)&#10;                }&#10;                SelectionMode.DELETE -&gt; {&#10;                    confirmDelete(test)&#10;                    selectionMode = SelectionMode.NONE&#10;                    tvMode.text = getString(R.string.mode_create)&#10;                }&#10;                SelectionMode.NONE -&gt; {&#10;                    // quick tap: populate for quick edit&#10;                    populateFormForEditing(test)&#10;                }&#10;            }&#10;        }&#10;        rvTests.layoutManager = LinearLayoutManager(requireContext())&#10;        rvTests.adapter = adapter&#10;    }&#10;&#10;    private fun loadTests() {&#10;        tests.clear()&#10;        tests.addAll(dbHelper.getAllTests())&#10;        adapter?.notifyDataSetChanged()&#10;    }&#10;&#10;    private fun populateFormForEditing(test: Test) {&#10;        currentEditingTest = test&#10;        tvMode.text = getString(R.string.mode_editing, test.name)&#10;        etTestName.setText(test.name)&#10;&#10;        val subjectPos = subjects.indexOfFirst { it.id == test.subjectId }&#10;        if (subjectPos &gt;= 0) spinnerSubject.setSelection(subjectPos)&#10;&#10;        cbEasy.isChecked = test.easyPercent &gt; 0&#10;        cbMedium.isChecked = test.mediumPercent &gt; 0&#10;        cbHard.isChecked = test.hardPercent &gt; 0&#10;&#10;        etNumberQuestions.setText(test.numQuestions.toString())&#10;        etMinutes.setText(test.durationMinutes.toString())&#10;        if (test.allowMultipleAnswers) rbYes.isChecked = true else rbNo.isChecked = true&#10;&#10;        btnAdd.text = getString(R.string.cap_nhat)&#10;    }&#10;&#10;    private fun confirmDelete(test: Test) {&#10;        AlertDialog.Builder(requireContext())&#10;            .setTitle(getString(R.string.xoa_de))&#10;            .setMessage(&quot;Bạn có chắc muốn xóa '${test.name}'?&quot;)&#10;            .setPositiveButton(&quot;Xóa&quot;) { dialog, _ -&gt;&#10;                val rows = dbHelper.deleteTest(test.testId)&#10;                if (rows &gt; 0) {&#10;                    Toast.makeText(requireContext(), &quot;Xóa thành công&quot;, Toast.LENGTH_SHORT).show()&#10;                    loadTests()&#10;                } else {&#10;                    Toast.makeText(requireContext(), &quot;Xóa thất bại&quot;, Toast.LENGTH_SHORT).show()&#10;                }&#10;                dialog.dismiss()&#10;            }&#10;            .setNegativeButton(&quot;Hủy&quot;, null)&#10;            .show()&#10;    }&#10;&#10;    private fun updateTest() {&#10;        val test = currentEditingTest ?: return&#10;&#10;        val selectedSubjectPosition = spinnerSubject.selectedItemPosition&#10;        if (selectedSubjectPosition &lt; 0 || selectedSubjectPosition &gt;= subjects.size) {&#10;            Toast.makeText(requireContext(), &quot;Vui lòng chọn môn học&quot;, Toast.LENGTH_SHORT).show()&#10;            return&#10;        }&#10;        val selectedSubject = subjects[selectedSubjectPosition]&#10;&#10;        val checkedDifficulties = listOf(cbEasy, cbMedium, cbHard).filter { it.isChecked }&#10;        if (checkedDifficulties.isEmpty()) {&#10;            Toast.makeText(requireContext(), &quot;Vui lòng chọn ít nhất một mức độ&quot;, Toast.LENGTH_SHORT).show()&#10;            return&#10;        }&#10;&#10;        val numQuestionsStr = etNumberQuestions.text.toString()&#10;        if (numQuestionsStr.isEmpty()) {&#10;            etNumberQuestions.error = &quot;Vui lòng nhập số câu hỏi&quot;&#10;            etNumberQuestions.requestFocus()&#10;            return&#10;        }&#10;&#10;        val questionCount = numQuestionsStr.toIntOrNull()&#10;        if (questionCount == null || questionCount &lt;= 0) {&#10;            etNumberQuestions.error = &quot;Số câu hỏi phải là số nguyên dương&quot;&#10;            etNumberQuestions.requestFocus()&#10;            return&#10;        }&#10;&#10;        val minutesStr = etMinutes.text.toString()&#10;        if (minutesStr.isEmpty()) {&#10;            etMinutes.error = &quot;Vui lòng nhập thời gian&quot;&#10;            etMinutes.requestFocus()&#10;            return&#10;        }&#10;&#10;        val minutes = minutesStr.toIntOrNull()&#10;        if (minutes == null || minutes &lt;= 0) {&#10;            etMinutes.error = &quot;Thời gian phải là số nguyên dương&quot;&#10;            etMinutes.requestFocus()&#10;            return&#10;        }&#10;&#10;        val allowMultipleAnswers = rbYes.isChecked&#10;&#10;        val totalChecked = checkedDifficulties.size&#10;        val percentPerSelection = 100 / totalChecked&#10;        var easyPercent = 0&#10;        var mediumPercent = 0&#10;        var hardPercent = 0&#10;&#10;        checkedDifficulties.forEach {&#10;            when (it.id) {&#10;                R.id.cb_easy -&gt; easyPercent = percentPerSelection&#10;                R.id.cb_medium -&gt; mediumPercent = percentPerSelection&#10;                R.id.cb_hard -&gt; hardPercent = percentPerSelection&#10;            }&#10;        }&#10;&#10;        val remainder = 100 % totalChecked&#10;        if (remainder &gt; 0 &amp;&amp; checkedDifficulties.isNotEmpty()) {&#10;            when (checkedDifficulties.first().id) {&#10;                R.id.cb_easy -&gt; easyPercent += remainder&#10;                R.id.cb_medium -&gt; mediumPercent += remainder&#10;                R.id.cb_hard -&gt; hardPercent += remainder&#10;            }&#10;        }&#10;&#10;        val name = etTestName.text.toString().ifEmpty { test.name }&#10;&#10;        val updatedTest = Test(&#10;            testId = test.testId,&#10;            subjectId = selectedSubject.id,&#10;            name = name,&#10;            numQuestions = questionCount,&#10;            durationMinutes = minutes,&#10;            allowMultipleAnswers = allowMultipleAnswers,&#10;            easyPercent = easyPercent,&#10;            mediumPercent = mediumPercent,&#10;            hardPercent = hardPercent,&#10;            createdAt = test.createdAt&#10;        )&#10;&#10;        val rows = dbHelper.updateTest(test.testId, updatedTest)&#10;        if (rows &gt; 0) {&#10;            Toast.makeText(requireContext(), &quot;Cập nhật thành công&quot;, Toast.LENGTH_SHORT).show()&#10;            currentEditingTest = null&#10;            btnAdd.text = getString(R.string.them)&#10;            tvMode.text = getString(R.string.mode_create)&#10;            etTestName.setText(&quot;&quot;)&#10;            loadTests()&#10;        } else {&#10;            Toast.makeText(requireContext(), &quot;Cập nhật thất bại&quot;, Toast.LENGTH_SHORT).show()&#10;        }&#10;    }&#10;&#10;    private fun createTest() {&#10;        val selectedSubjectPosition = spinnerSubject.selectedItemPosition&#10;        if (selectedSubjectPosition &lt; 0 || selectedSubjectPosition &gt;= subjects.size) {&#10;            Toast.makeText(requireContext(), &quot;Vui lòng chọn môn học&quot;, Toast.LENGTH_SHORT).show()&#10;            return&#10;        }&#10;        val selectedSubject = subjects[selectedSubjectPosition]&#10;&#10;        val checkedDifficulties = listOf(cbEasy, cbMedium, cbHard).filter { it.isChecked }&#10;        if (checkedDifficulties.isEmpty()) {&#10;            Toast.makeText(requireContext(), &quot;Vui lòng chọn ít nhất một mức độ&quot;, Toast.LENGTH_SHORT).show()&#10;            return&#10;        }&#10;&#10;        val numQuestionsStr = etNumberQuestions.text.toString()&#10;        if (numQuestionsStr.isEmpty()) {&#10;            etNumberQuestions.error = &quot;Vui lòng nhập số câu hỏi&quot;&#10;            etNumberQuestions.requestFocus()&#10;            return&#10;        }&#10;&#10;        val questionCount = numQuestionsStr.toIntOrNull()&#10;        if (questionCount == null || questionCount &lt;= 0) {&#10;            etNumberQuestions.error = &quot;Số câu hỏi phải là số nguyên dương&quot;&#10;            etNumberQuestions.requestFocus()&#10;            return&#10;        }&#10;&#10;        val minutesStr = etMinutes.text.toString()&#10;        if (minutesStr.isEmpty()) {&#10;            etMinutes.error = &quot;Vui lòng nhập thời gian&quot;&#10;            etMinutes.requestFocus()&#10;            return&#10;        }&#10;&#10;        val minutes = minutesStr.toIntOrNull()&#10;        if (minutes == null || minutes &lt;= 0) {&#10;            etMinutes.error = &quot;Thời gian phải là số nguyên dương&quot;&#10;            etMinutes.requestFocus()&#10;            return&#10;        }&#10;&#10;        val allowMultipleAnswers = rbYes.isChecked&#10;&#10;        val totalChecked = checkedDifficulties.size&#10;        val percentPerSelection = 100 / totalChecked&#10;        var easyPercent = 0&#10;        var mediumPercent = 0&#10;        var hardPercent = 0&#10;&#10;        checkedDifficulties.forEach {&#10;            when (it.id) {&#10;                R.id.cb_easy -&gt; easyPercent = percentPerSelection&#10;                R.id.cb_medium -&gt; mediumPercent = percentPerSelection&#10;                R.id.cb_hard -&gt; hardPercent = percentPerSelection&#10;            }&#10;        }&#10;&#10;        val remainder = 100 % totalChecked&#10;        if (remainder &gt; 0 &amp;&amp; checkedDifficulties.isNotEmpty()) {&#10;            when (checkedDifficulties.first().id) {&#10;                R.id.cb_easy -&gt; easyPercent += remainder&#10;                R.id.cb_medium -&gt; mediumPercent += remainder&#10;                R.id.cb_hard -&gt; hardPercent += remainder&#10;            }&#10;        }&#10;&#10;        val nameFromField = etTestName.text.toString().ifEmpty { &quot;Đề thi môn ${selectedSubject.name}&quot; }&#10;&#10;        val newTest = Test(&#10;            subjectId = selectedSubject.id,&#10;            name = nameFromField,&#10;            numQuestions = questionCount,&#10;            durationMinutes = minutes,&#10;            allowMultipleAnswers = allowMultipleAnswers,&#10;            easyPercent = easyPercent,&#10;            mediumPercent = mediumPercent,&#10;            hardPercent = hardPercent&#10;        )&#10;&#10;        val result = dbHelper.addTest(newTest)&#10;&#10;        if (result != -1L) {&#10;            Toast.makeText(requireContext(), &quot;Tạo đề thi thành công!&quot;, Toast.LENGTH_SHORT).show()&#10;            etTestName.setText(&quot;&quot;)&#10;            clearForm()&#10;            loadTests()&#10;        } else {&#10;            Toast.makeText(requireContext(), &quot;Lỗi khi tạo đề thi&quot;, Toast.LENGTH_SHORT).show()&#10;        }&#10;    }&#10;&#10;    private fun clearForm() {&#10;        cbEasy.isChecked = false&#10;        cbMedium.isChecked = false&#10;        cbHard.isChecked = false&#10;        etNumberQuestions.setText(&quot;&quot;)&#10;        etMinutes.setText(&quot;&quot;)&#10;        rbNo.isChecked = true&#10;    }&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/app/src/main/res/layout/fragment_create_test.xml">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/res/layout/fragment_create_test.xml" />
              <option name="originalContent" value="&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&#10;&lt;ScrollView xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;&#10;    xmlns:app=&quot;http://schemas.android.com/apk/res-auto&quot;&#10;    android:layout_width=&quot;match_parent&quot;&#10;    android:layout_height=&quot;match_parent&quot;&#10;    android:background=&quot;#FFFFFFFF&quot;&#10;    android:padding=&quot;12dp&quot;&#10;    android:paddingTop=&quot;16dp&quot;&gt;&#10;&#10;    &lt;LinearLayout&#10;        android:layout_width=&quot;match_parent&quot;&#10;        android:layout_height=&quot;wrap_content&quot;&#10;        android:orientation=&quot;vertical&quot;&gt;&#10;&#10;        &lt;!-- Header --&gt;&#10;        &lt;LinearLayout&#10;            android:layout_width=&quot;match_parent&quot;&#10;            android:layout_height=&quot;wrap_content&quot;&#10;            android:orientation=&quot;horizontal&quot;&#10;            android:gravity=&quot;center_vertical&quot;&#10;            android:paddingBottom=&quot;16dp&quot;&gt;&#10;&#10;            &lt;ImageView&#10;                android:id=&quot;@+id/ivBack&quot;&#10;                android:layout_width=&quot;wrap_content&quot;&#10;                android:layout_height=&quot;wrap_content&quot;&#10;                android:src=&quot;@drawable/ic_back&quot;&#10;                android:padding=&quot;8dp&quot;&#10;                android:clickable=&quot;true&quot;&#10;                android:focusable=&quot;true&quot;&#10;                android:contentDescription=&quot;@string/back_arrow&quot;/&gt;&#10;&#10;            &lt;TextView&#10;                android:id=&quot;@+id/tvCreateTitle&quot;&#10;                android:layout_width=&quot;0dp&quot;&#10;                android:layout_height=&quot;wrap_content&quot;&#10;                android:layout_weight=&quot;1&quot;&#10;                android:text=&quot;@string/title_tao_de&quot;&#10;                android:textStyle=&quot;bold&quot;&#10;                android:textSize=&quot;18sp&quot;&#10;                android:textColor=&quot;#000000&quot;&#10;                android:paddingStart=&quot;8dp&quot; /&gt;&#10;&#10;            &lt;TextView&#10;                android:id=&quot;@+id/tvAdd&quot;&#10;                android:layout_width=&quot;wrap_content&quot;&#10;                android:layout_height=&quot;wrap_content&quot;&#10;                android:text=&quot;@string/them&quot;&#10;                android:textSize=&quot;14sp&quot;&#10;                android:textColor=&quot;#0066CC&quot;&#10;                android:padding=&quot;8dp&quot;&#10;                android:clickable=&quot;true&quot;&#10;                android:focusable=&quot;true&quot; /&gt;&#10;&#10;        &lt;/LinearLayout&gt;&#10;&#10;        &lt;!-- Form --&gt;&#10;        &lt;TextView&#10;            android:layout_width=&quot;wrap_content&quot;&#10;            android:layout_height=&quot;wrap_content&quot;&#10;            android:text=&quot;@string/chon_mon_hoc&quot;&#10;            android:textSize=&quot;14sp&quot;&#10;            android:layout_marginTop=&quot;12dp&quot; /&gt;&#10;&#10;        &lt;Spinner&#10;            android:id=&quot;@+id/spinner_subject&quot;&#10;            android:layout_width=&quot;match_parent&quot;&#10;            android:layout_height=&quot;48dp&quot;&#10;            android:layout_marginTop=&quot;8dp&quot;&#10;            android:padding=&quot;8dp&quot;&#10;            android:background=&quot;@android:drawable/editbox_background_normal&quot; /&gt;&#10;&#10;        &lt;TextView&#10;            android:layout_width=&quot;wrap_content&quot;&#10;            android:layout_height=&quot;wrap_content&quot;&#10;            android:text=&quot;@string/chon_muc_do&quot;&#10;            android:textSize=&quot;14sp&quot;&#10;            android:layout_marginTop=&quot;16dp&quot; /&gt;&#10;&#10;        &lt;LinearLayout&#10;            android:layout_width=&quot;match_parent&quot;&#10;            android:layout_height=&quot;wrap_content&quot;&#10;            android:orientation=&quot;horizontal&quot;&#10;            android:layout_marginTop=&quot;8dp&quot;&gt;&#10;&#10;            &lt;CheckBox&#10;                android:id=&quot;@+id/cb_easy&quot;&#10;                android:layout_width=&quot;wrap_content&quot;&#10;                android:layout_height=&quot;wrap_content&quot;&#10;                android:text=&quot;@string/de&quot; /&gt;&#10;&#10;            &lt;CheckBox&#10;                android:id=&quot;@+id/cb_medium&quot;&#10;                android:layout_width=&quot;wrap_content&quot;&#10;                android:layout_height=&quot;wrap_content&quot;&#10;                android:text=&quot;@string/vua&quot;&#10;                android:layout_marginStart=&quot;16dp&quot; /&gt;&#10;&#10;            &lt;CheckBox&#10;                android:id=&quot;@+id/cb_hard&quot;&#10;                android:layout_width=&quot;wrap_content&quot;&#10;                android:layout_height=&quot;wrap_content&quot;&#10;                android:text=&quot;@string/kho&quot;&#10;                android:layout_marginStart=&quot;16dp&quot; /&gt;&#10;&#10;        &lt;/LinearLayout&gt;&#10;&#10;        &lt;TextView&#10;            android:layout_width=&quot;wrap_content&quot;&#10;            android:layout_height=&quot;wrap_content&quot;&#10;            android:text=&quot;@string/nhap_so_cau_label&quot;&#10;            android:textSize=&quot;14sp&quot;&#10;            android:layout_marginTop=&quot;16dp&quot; /&gt;&#10;&#10;        &lt;EditText&#10;            android:id=&quot;@+id/et_number_questions&quot;&#10;            android:layout_width=&quot;match_parent&quot;&#10;            android:layout_height=&quot;48dp&quot;&#10;            android:layout_marginTop=&quot;8dp&quot;&#10;            android:hint=&quot;@string/nhap_so_cau_hint&quot;&#10;            android:background=&quot;@android:drawable/edit_text&quot;&#10;            android:padding=&quot;8dp&quot; /&gt;&#10;&#10;        &lt;TextView&#10;            android:layout_width=&quot;wrap_content&quot;&#10;            android:layout_height=&quot;wrap_content&quot;&#10;            android:text=&quot;@string/cau_chon_nhieu&quot;&#10;            android:textSize=&quot;14sp&quot;&#10;            android:layout_marginTop=&quot;16dp&quot; /&gt;&#10;&#10;        &lt;RadioGroup&#10;            android:id=&quot;@+id/rg_multiple_choice&quot;&#10;            android:layout_width=&quot;wrap_content&quot;&#10;            android:layout_height=&quot;wrap_content&quot;&#10;            android:orientation=&quot;horizontal&quot;&#10;            android:layout_marginTop=&quot;8dp&quot;&gt;&#10;&#10;            &lt;RadioButton&#10;                android:id=&quot;@+id/rb_yes&quot;&#10;                android:layout_width=&quot;wrap_content&quot;&#10;                android:layout_height=&quot;wrap_content&quot;&#10;                android:text=&quot;@string/co&quot; /&gt;&#10;&#10;            &lt;RadioButton&#10;                android:id=&quot;@+id/rb_no&quot;&#10;                android:layout_width=&quot;wrap_content&quot;&#10;                android:layout_height=&quot;wrap_content&quot;&#10;                android:text=&quot;@string/khong&quot;&#10;                android:layout_marginStart=&quot;12dp&quot; /&gt;&#10;&#10;        &lt;/RadioGroup&gt;&#10;&#10;        &lt;TextView&#10;            android:layout_width=&quot;wrap_content&quot;&#10;            android:layout_height=&quot;wrap_content&quot;&#10;            android:text=&quot;@string/nhap_so_phut_label&quot;&#10;            android:textSize=&quot;14sp&quot;&#10;            android:layout_marginTop=&quot;16dp&quot; /&gt;&#10;&#10;        &lt;EditText&#10;            android:id=&quot;@+id/et_minutes&quot;&#10;            android:layout_width=&quot;match_parent&quot;&#10;            android:layout_height=&quot;48dp&quot;&#10;            android:layout_marginTop=&quot;8dp&quot;&#10;            android:hint=&quot;@string/nhap_so_phut_hint&quot;&#10;            android:background=&quot;@android:drawable/edit_text&quot;&#10;            android:padding=&quot;8dp&quot; /&gt;&#10;&#10;        &lt;!-- Spacer --&gt;&#10;        &lt;View&#10;            android:layout_width=&quot;match_parent&quot;&#10;            android:layout_height=&quot;80dp&quot; /&gt;&#10;&#10;    &lt;/LinearLayout&gt;&#10;&#10;&lt;/ScrollView&gt;&#10;" />
              <option name="updatedContent" value="&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&#10;&lt;ScrollView xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;&#10;    android:layout_width=&quot;match_parent&quot;&#10;    android:layout_height=&quot;match_parent&quot;&#10;    android:background=&quot;#FFFFFFFF&quot;&#10;    android:padding=&quot;12dp&quot;&#10;    android:paddingTop=&quot;16dp&quot;&gt;&#10;&#10;    &lt;LinearLayout&#10;        android:layout_width=&quot;match_parent&quot;&#10;        android:layout_height=&quot;wrap_content&quot;&#10;        android:orientation=&quot;vertical&quot;&gt;&#10;&#10;        &lt;!-- Header --&gt;&#10;        &lt;LinearLayout&#10;            android:layout_width=&quot;match_parent&quot;&#10;            android:layout_height=&quot;wrap_content&quot;&#10;            android:orientation=&quot;horizontal&quot;&#10;            android:gravity=&quot;center_vertical&quot;&#10;            android:paddingBottom=&quot;12dp&quot;&gt;&#10;&#10;            &lt;ImageView&#10;                android:id=&quot;@+id/ivBack&quot;&#10;                android:layout_width=&quot;wrap_content&quot;&#10;                android:layout_height=&quot;wrap_content&quot;&#10;                android:src=&quot;@drawable/ic_back&quot;&#10;                android:padding=&quot;8dp&quot;&#10;                android:clickable=&quot;true&quot;&#10;                android:focusable=&quot;true&quot;&#10;                android:contentDescription=&quot;@string/back_arrow&quot;/&gt;&#10;&#10;            &lt;TextView&#10;                android:id=&quot;@+id/tvCreateTitle&quot;&#10;                android:layout_width=&quot;0dp&quot;&#10;                android:layout_height=&quot;wrap_content&quot;&#10;                android:layout_weight=&quot;1&quot;&#10;                android:text=&quot;@string/title_tao_de&quot;&#10;                android:textStyle=&quot;bold&quot;&#10;                android:textSize=&quot;18sp&quot;&#10;                android:textColor=&quot;#000000&quot;&#10;                android:paddingStart=&quot;8dp&quot;&#10;                android:paddingEnd=&quot;8dp&quot; /&gt;&#10;&#10;            &lt;!-- Actions as buttons for clarity --&gt;&#10;            &lt;Button&#10;                android:id=&quot;@+id/btnAdd&quot;&#10;                style=&quot;@style/Widget.AppCompat.Button.Borderless&quot;&#10;                android:layout_width=&quot;wrap_content&quot;&#10;                android:layout_height=&quot;wrap_content&quot;&#10;                android:text=&quot;@string/them&quot;&#10;                android:textColor=&quot;#0066CC&quot;&#10;                android:padding=&quot;8dp&quot; /&gt;&#10;&#10;            &lt;Button&#10;                android:id=&quot;@+id/btnEdit&quot;&#10;                style=&quot;@style/Widget.AppCompat.Button.Borderless&quot;&#10;                android:layout_width=&quot;wrap_content&quot;&#10;                android:layout_height=&quot;wrap_content&quot;&#10;                android:layout_marginStart=&quot;8dp&quot;&#10;                android:text=&quot;@string/sua&quot;&#10;                android:textColor=&quot;#FF9800&quot;&#10;                android:padding=&quot;8dp&quot;&#10;                android:contentDescription=&quot;@string/sua_de&quot; /&gt;&#10;&#10;            &lt;Button&#10;                android:id=&quot;@+id/btnDelete&quot;&#10;                style=&quot;@style/Widget.AppCompat.Button.Borderless&quot;&#10;                android:layout_width=&quot;wrap_content&quot;&#10;                android:layout_height=&quot;wrap_content&quot;&#10;                android:layout_marginStart=&quot;8dp&quot;&#10;                android:text=&quot;@string/xoa&quot;&#10;                android:textColor=&quot;#D32F2F&quot;&#10;                android:padding=&quot;8dp&quot;&#10;                android:contentDescription=&quot;@string/xoa_de&quot; /&gt;&#10;&#10;        &lt;/LinearLayout&gt;&#10;&#10;        &lt;!-- Mode indicator and Test name (editable) --&gt;&#10;        &lt;TextView&#10;            android:id=&quot;@+id/tvMode&quot;&#10;            android:layout_width=&quot;wrap_content&quot;&#10;            android:layout_height=&quot;wrap_content&quot;&#10;            android:text=&quot;@string/title_tao_de&quot;&#10;            android:textStyle=&quot;bold&quot;&#10;            android:layout_marginTop=&quot;4dp&quot; /&gt;&#10;&#10;        &lt;EditText&#10;            android:id=&quot;@+id/et_test_name&quot;&#10;            android:layout_width=&quot;match_parent&quot;&#10;            android:layout_height=&quot;48dp&quot;&#10;            android:layout_marginTop=&quot;8dp&quot;&#10;            android:hint=&quot;@string/hint_test_name&quot;&#10;            android:background=&quot;@android:drawable/edit_text&quot;&#10;            android:padding=&quot;8dp&quot;&#10;            android:inputType=&quot;textCapSentences|text&quot;&#10;            android:importantForAutofill=&quot;no&quot; /&gt;&#10;&#10;        &lt;!-- Form --&gt;&#10;        &lt;TextView&#10;            android:layout_width=&quot;wrap_content&quot;&#10;            android:layout_height=&quot;wrap_content&quot;&#10;            android:text=&quot;@string/chon_mon_hoc&quot;&#10;            android:textSize=&quot;14sp&quot;&#10;            android:layout_marginTop=&quot;12dp&quot; /&gt;&#10;&#10;        &lt;Spinner&#10;            android:id=&quot;@+id/spinner_subject&quot;&#10;            android:layout_width=&quot;match_parent&quot;&#10;            android:layout_height=&quot;48dp&quot;&#10;            android:layout_marginTop=&quot;8dp&quot;&#10;            android:padding=&quot;8dp&quot;&#10;            android:background=&quot;@android:drawable/editbox_background_normal&quot; /&gt;&#10;&#10;        &lt;TextView&#10;            android:layout_width=&quot;wrap_content&quot;&#10;            android:layout_height=&quot;wrap_content&quot;&#10;            android:text=&quot;@string/chon_muc_do&quot;&#10;            android:textSize=&quot;14sp&quot;&#10;            android:layout_marginTop=&quot;16dp&quot; /&gt;&#10;&#10;        &lt;LinearLayout&#10;            android:layout_width=&quot;match_parent&quot;&#10;            android:layout_height=&quot;wrap_content&quot;&#10;            android:orientation=&quot;horizontal&quot;&#10;            android:layout_marginTop=&quot;8dp&quot;&gt;&#10;&#10;            &lt;CheckBox&#10;                android:id=&quot;@+id/cb_easy&quot;&#10;                android:layout_width=&quot;wrap_content&quot;&#10;                android:layout_height=&quot;wrap_content&quot;&#10;                android:text=&quot;@string/de&quot; /&gt;&#10;&#10;            &lt;CheckBox&#10;                android:id=&quot;@+id/cb_medium&quot;&#10;                android:layout_width=&quot;wrap_content&quot;&#10;                android:layout_height=&quot;wrap_content&quot;&#10;                android:text=&quot;@string/vua&quot;&#10;                android:layout_marginStart=&quot;16dp&quot; /&gt;&#10;&#10;            &lt;CheckBox&#10;                android:id=&quot;@+id/cb_hard&quot;&#10;                android:layout_width=&quot;wrap_content&quot;&#10;                android:layout_height=&quot;wrap_content&quot;&#10;                android:text=&quot;@string/kho&quot;&#10;                android:layout_marginStart=&quot;16dp&quot; /&gt;&#10;&#10;        &lt;/LinearLayout&gt;&#10;&#10;        &lt;TextView&#10;            android:layout_width=&quot;wrap_content&quot;&#10;            android:layout_height=&quot;wrap_content&quot;&#10;            android:text=&quot;@string/nhap_so_cau_label&quot;&#10;            android:textSize=&quot;14sp&quot;&#10;            android:layout_marginTop=&quot;16dp&quot; /&gt;&#10;&#10;        &lt;EditText&#10;            android:id=&quot;@+id/et_number_questions&quot;&#10;            android:layout_width=&quot;match_parent&quot;&#10;            android:layout_height=&quot;48dp&quot;&#10;            android:layout_marginTop=&quot;8dp&quot;&#10;            android:hint=&quot;@string/nhap_so_cau_hint&quot;&#10;            android:background=&quot;@android:drawable/edit_text&quot;&#10;            android:padding=&quot;8dp&quot;&#10;            android:inputType=&quot;number&quot;&#10;            android:importantForAutofill=&quot;no&quot; /&gt;&#10;&#10;        &lt;TextView&#10;            android:layout_width=&quot;wrap_content&quot;&#10;            android:layout_height=&quot;wrap_content&quot;&#10;            android:text=&quot;@string/cau_chon_nhieu&quot;&#10;            android:textSize=&quot;14sp&quot;&#10;            android:layout_marginTop=&quot;16dp&quot; /&gt;&#10;&#10;        &lt;RadioGroup&#10;            android:id=&quot;@+id/rg_multiple_choice&quot;&#10;            android:layout_width=&quot;wrap_content&quot;&#10;            android:layout_height=&quot;wrap_content&quot;&#10;            android:orientation=&quot;horizontal&quot;&#10;            android:layout_marginTop=&quot;8dp&quot;&gt;&#10;&#10;            &lt;RadioButton&#10;                android:id=&quot;@+id/rb_yes&quot;&#10;                android:layout_width=&quot;wrap_content&quot;&#10;                android:layout_height=&quot;wrap_content&quot;&#10;                android:text=&quot;@string/co&quot; /&gt;&#10;&#10;            &lt;RadioButton&#10;                android:id=&quot;@+id/rb_no&quot;&#10;                android:layout_width=&quot;wrap_content&quot;&#10;                android:layout_height=&quot;wrap_content&quot;&#10;                android:text=&quot;@string/khong&quot;&#10;                android:layout_marginStart=&quot;12dp&quot; /&gt;&#10;&#10;        &lt;/RadioGroup&gt;&#10;&#10;        &lt;TextView&#10;            android:layout_width=&quot;wrap_content&quot;&#10;            android:layout_height=&quot;wrap_content&quot;&#10;            android:text=&quot;@string/nhap_so_phut_label&quot;&#10;            android:textSize=&quot;14sp&quot;&#10;            android:layout_marginTop=&quot;16dp&quot; /&gt;&#10;&#10;        &lt;EditText&#10;            android:id=&quot;@+id/et_minutes&quot;&#10;            android:layout_width=&quot;match_parent&quot;&#10;            android:layout_height=&quot;48dp&quot;&#10;            android:layout_marginTop=&quot;8dp&quot;&#10;            android:hint=&quot;@string/nhap_so_phut_hint&quot;&#10;            android:background=&quot;@android:drawable/edit_text&quot;&#10;            android:padding=&quot;8dp&quot;&#10;            android:inputType=&quot;number&quot;&#10;            android:importantForAutofill=&quot;no&quot; /&gt;&#10;&#10;        &lt;!-- Recycler of existing tests --&gt;&#10;        &lt;TextView&#10;            android:layout_width=&quot;wrap_content&quot;&#10;            android:layout_height=&quot;wrap_content&quot;&#10;            android:text=&quot;@string/label_test_list&quot;&#10;            android:textStyle=&quot;bold&quot;&#10;            android:layout_marginTop=&quot;16dp&quot; /&gt;&#10;&#10;        &lt;androidx.recyclerview.widget.RecyclerView&#10;            android:id=&quot;@+id/rvTests&quot;&#10;            android:layout_width=&quot;match_parent&quot;&#10;            android:layout_height=&quot;200dp&quot;&#10;            android:layout_marginTop=&quot;8dp&quot; /&gt;&#10;&#10;        &lt;!-- Spacer --&gt;&#10;        &lt;View&#10;            android:layout_width=&quot;match_parent&quot;&#10;            android:layout_height=&quot;80dp&quot; /&gt;&#10;&#10;    &lt;/LinearLayout&gt;&#10;&#10;&lt;/ScrollView&gt;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/app/src/main/res/layout/item_subject.xml">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/res/layout/item_subject.xml" />
              <option name="updatedContent" value="&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&#10;&lt;LinearLayout xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;&#10;    android:layout_width=&quot;match_parent&quot;&#10;    android:layout_height=&quot;wrap_content&quot;&#10;    android:orientation=&quot;horizontal&quot;&#10;    android:gravity=&quot;center_vertical&quot;&#10;    android:padding=&quot;12dp&quot;&#10;    android:layout_marginBottom=&quot;8dp&quot;&#10;    android:background=&quot;@android:color/transparent&quot;&gt;&#10;&#10;    &lt;TextView&#10;        android:id=&quot;@+id/tvSubjectName&quot;&#10;        android:layout_width=&quot;0dp&quot;&#10;        android:layout_height=&quot;wrap_content&quot;&#10;        android:layout_weight=&quot;1&quot;&#10;        android:text=&quot;Môn học&quot;&#10;        android:textSize=&quot;16sp&quot;&#10;        android:textColor=&quot;#000000&quot;&#10;        android:textStyle=&quot;bold&quot; /&gt;&#10;&#10;    &lt;Button&#10;        android:id=&quot;@+id/btnEdit&quot;&#10;        android:layout_width=&quot;wrap_content&quot;&#10;        android:layout_height=&quot;wrap_content&quot;&#10;        android:text=&quot;@string/sua&quot;&#10;        android:textColor=&quot;#FF9800&quot;&#10;        android:background=&quot;?android:attr/selectableItemBackgroundBorderless&quot;&#10;        android:padding=&quot;8dp&quot;&#10;        android:layout_marginEnd=&quot;8dp&quot;/&gt;&#10;&#10;    &lt;Button&#10;        android:id=&quot;@+id/btnDelete&quot;&#10;        android:layout_width=&quot;wrap_content&quot;&#10;        android:layout_height=&quot;wrap_content&quot;&#10;        android:text=&quot;@string/xoa&quot;&#10;        android:textColor=&quot;#D32F2F&quot;&#10;        android:background=&quot;?android:attr/selectableItemBackgroundBorderless&quot;&#10;        android:padding=&quot;8dp&quot;/&gt;&#10;&#10;&lt;/LinearLayout&gt;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/app/src/main/res/values/strings.xml">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/res/values/strings.xml" />
              <option name="originalContent" value="&lt;resources&gt;&#10;    &lt;string name=&quot;app_name&quot;&gt;DA&lt;/string&gt;&#10;    &lt;string name=&quot;home_title&quot;&gt;Home&lt;/string&gt;&#10;    &lt;string name=&quot;create_test&quot;&gt;+  Tạo đề&lt;/string&gt;&#10;    &lt;string name=&quot;section_list&quot;&gt;Danh sách đề&lt;/string&gt;&#10;    &lt;string name=&quot;subject_math&quot;&gt;Toán&lt;/string&gt;&#10;    &lt;string name=&quot;subject_physics&quot;&gt;Lý&lt;/string&gt;&#10;    &lt;string name=&quot;subject_chemistry&quot;&gt;Hóa&lt;/string&gt;&#10;    &lt;string name=&quot;subject_english&quot;&gt;Tiếng anh&lt;/string&gt;&#10;    &lt;string name=&quot;difficulty_easy&quot;&gt;Dễ&lt;/string&gt;&#10;    &lt;string name=&quot;difficulty_medium&quot;&gt;Vừa&lt;/string&gt;&#10;    &lt;string name=&quot;difficulty_hard&quot;&gt;Khó&lt;/string&gt;&#10;    &lt;string name=&quot;time_60&quot;&gt;60 Phút&lt;/string&gt;&#10;    &lt;string name=&quot;time_45&quot;&gt;45 Phút&lt;/string&gt;&#10;    &lt;string name=&quot;time_15&quot;&gt;15 Phút&lt;/string&gt;&#10;    &lt;string name=&quot;cd_subject_icon&quot;&gt;Icon môn học&lt;/string&gt;&#10;&#10;    &lt;!-- Create Test screen strings --&gt;&#10;    &lt;string name=&quot;title_tao_de&quot;&gt;Tạo đề&lt;/string&gt;&#10;    &lt;string name=&quot;them&quot;&gt;Thêm&lt;/string&gt;&#10;    &lt;string name=&quot;chon_mon_hoc&quot;&gt;Chọn môn học&lt;/string&gt;&#10;    &lt;string name=&quot;chon_muc_do&quot;&gt;Chọn mức độ&lt;/string&gt;&#10;    &lt;string name=&quot;de&quot;&gt;Dễ&lt;/string&gt;&#10;    &lt;string name=&quot;vua&quot;&gt;Vừa&lt;/string&gt;&#10;    &lt;string name=&quot;kho&quot;&gt;Khó&lt;/string&gt;&#10;    &lt;string name=&quot;nhap_so_cau_label&quot;&gt;Nhập số câu&lt;/string&gt;&#10;    &lt;string name=&quot;nhap_so_cau_hint&quot;&gt;Nhập số câu&amp;#8230;&lt;/string&gt;&#10;    &lt;string name=&quot;cau_chon_nhieu&quot;&gt;Câu chọn nhiều&lt;/string&gt;&#10;    &lt;string name=&quot;co&quot;&gt;Có&lt;/string&gt;&#10;    &lt;string name=&quot;khong&quot;&gt;Không&lt;/string&gt;&#10;    &lt;string name=&quot;nhap_so_phut_label&quot;&gt;Nhập số phút&lt;/string&gt;&#10;    &lt;string name=&quot;nhap_so_phut_hint&quot;&gt;VD : 60.&lt;/string&gt;&#10;    &lt;string name=&quot;back_arrow&quot;&gt;‹&lt;/string&gt;&#10;&#10;    &lt;!-- Management screen strings --&gt;&#10;    &lt;string name=&quot;quan_ly_title&quot;&gt;Quản lý&lt;/string&gt;&#10;    &lt;string name=&quot;tao_moi_cau_hoi&quot;&gt;+ Tạo mới câu hỏi&lt;/string&gt;&#10;    &lt;string name=&quot;tab_tat_ca&quot;&gt;Tất cả&lt;/string&gt;&#10;    &lt;string name=&quot;tab_tieng_anh&quot;&gt;Tiếng anh&lt;/string&gt;&#10;    &lt;string name=&quot;tab_toan_hoc&quot;&gt;Toán học&lt;/string&gt;&#10;    &lt;string name=&quot;tab_lich_su&quot;&gt;Lịch sử&lt;/string&gt;&#10;    &lt;string name=&quot;tab_dia_li&quot;&gt;Địa lí&lt;/string&gt;&#10;    &lt;string name=&quot;tab_hoa_hoc&quot;&gt;Hóa học&lt;/string&gt;&#10;    &lt;string name=&quot;sample_question&quot;&gt;What is english ?&lt;/string&gt;&#10;    &lt;string name=&quot;muc_do_de_label&quot;&gt;Mức độ - Dễ&lt;/string&gt;&#10;    &lt;string name=&quot;cd_delete_icon&quot;&gt;Xóa câu hỏi&lt;/string&gt;&#10;    &lt;string name=&quot;num_questions_format&quot;&gt;Số câu: %d&lt;/string&gt;&#10;    &lt;string name=&quot;duration_format&quot;&gt;%d Phút&lt;/string&gt;&#10;&lt;/resources&gt;" />
              <option name="updatedContent" value="&lt;resources&gt;&#10;    &lt;string name=&quot;app_name&quot;&gt;DA&lt;/string&gt;&#10;    &lt;string name=&quot;home_title&quot;&gt;Home&lt;/string&gt;&#10;    &lt;string name=&quot;create_test&quot;&gt;+  Tạo đề&lt;/string&gt;&#10;    &lt;string name=&quot;section_list&quot;&gt;Danh sách đề&lt;/string&gt;&#10;    &lt;string name=&quot;subject_math&quot;&gt;Toán&lt;/string&gt;&#10;    &lt;string name=&quot;subject_physics&quot;&gt;Lý&lt;/string&gt;&#10;    &lt;string name=&quot;subject_chemistry&quot;&gt;Hóa&lt;/string&gt;&#10;    &lt;string name=&quot;subject_english&quot;&gt;Tiếng anh&lt;/string&gt;&#10;    &lt;string name=&quot;difficulty_easy&quot;&gt;Dễ&lt;/string&gt;&#10;    &lt;string name=&quot;difficulty_medium&quot;&gt;Vừa&lt;/string&gt;&#10;    &lt;string name=&quot;difficulty_hard&quot;&gt;Khó&lt;/string&gt;&#10;    &lt;string name=&quot;time_60&quot;&gt;60 Phút&lt;/string&gt;&#10;    &lt;string name=&quot;time_45&quot;&gt;45 Phút&lt;/string&gt;&#10;    &lt;string name=&quot;time_15&quot;&gt;15 Phút&lt;/string&gt;&#10;    &lt;string name=&quot;cd_subject_icon&quot;&gt;Icon môn học&lt;/string&gt;&#10;&#10;    &lt;!-- Create Test screen strings --&gt;&#10;    &lt;string name=&quot;title_tao_de&quot;&gt;Tạo đề&lt;/string&gt;&#10;    &lt;string name=&quot;them&quot;&gt;Thêm&lt;/string&gt;&#10;    &lt;string name=&quot;chon_mon_hoc&quot;&gt;Chọn môn học&lt;/string&gt;&#10;    &lt;string name=&quot;chon_muc_do&quot;&gt;Chọn mức độ&lt;/string&gt;&#10;    &lt;string name=&quot;de&quot;&gt;Dễ&lt;/string&gt;&#10;    &lt;string name=&quot;vua&quot;&gt;Vừa&lt;/string&gt;&#10;    &lt;string name=&quot;kho&quot;&gt;Khó&lt;/string&gt;&#10;    &lt;string name=&quot;nhap_so_cau_label&quot;&gt;Nhập số câu&lt;/string&gt;&#10;    &lt;string name=&quot;nhap_so_cau_hint&quot;&gt;Nhập số câu&amp;#8230;&lt;/string&gt;&#10;    &lt;string name=&quot;cau_chon_nhieu&quot;&gt;Câu chọn nhiều&lt;/string&gt;&#10;    &lt;string name=&quot;co&quot;&gt;Có&lt;/string&gt;&#10;    &lt;string name=&quot;khong&quot;&gt;Không&lt;/string&gt;&#10;    &lt;string name=&quot;nhap_so_phut_label&quot;&gt;Nhập số phút&lt;/string&gt;&#10;    &lt;string name=&quot;nhap_so_phut_hint&quot;&gt;VD : 60.&lt;/string&gt;&#10;    &lt;string name=&quot;back_arrow&quot;&gt;‹&lt;/string&gt;&#10;    &lt;string name=&quot;cap_nhat&quot;&gt;Cập nhật&lt;/string&gt;&#10;    &lt;string name=&quot;sua&quot;&gt;Sửa&lt;/string&gt;&#10;    &lt;string name=&quot;sua_de&quot;&gt;Sửa đề&lt;/string&gt;&#10;    &lt;string name=&quot;xoa&quot;&gt;Xóa&lt;/string&gt;&#10;    &lt;string name=&quot;xoa_de&quot;&gt;Xóa đề&lt;/string&gt;&#10;    &lt;string name=&quot;choose_test_to_edit&quot;&gt;Chọn đề để sửa&lt;/string&gt;&#10;    &lt;string name=&quot;choose_test_to_delete&quot;&gt;Chọn đề để xóa&lt;/string&gt;&#10;    &lt;string name=&quot;mode_create&quot;&gt;Tạo đề&lt;/string&gt;&#10;    &lt;string name=&quot;mode_editing&quot;&gt;Đang sửa: %1$s&lt;/string&gt;&#10;    &lt;string name=&quot;hint_test_name&quot;&gt;Tên đề (tùy chọn)&lt;/string&gt;&#10;    &lt;string name=&quot;label_test_list&quot;&gt;Danh sách đề&lt;/string&gt;&#10;&#10;    &lt;!-- Management screen strings --&gt;&#10;    &lt;string name=&quot;quan_ly_title&quot;&gt;Quản lý&lt;/string&gt;&#10;    &lt;string name=&quot;tao_moi_cau_hoi&quot;&gt;+ Tạo mới câu hỏi&lt;/string&gt;&#10;    &lt;string name=&quot;tab_tat_ca&quot;&gt;Tất cả&lt;/string&gt;&#10;    &lt;string name=&quot;tab_tieng_anh&quot;&gt;Tiếng anh&lt;/string&gt;&#10;    &lt;string name=&quot;tab_toan_hoc&quot;&gt;Toán học&lt;/string&gt;&#10;    &lt;string name=&quot;tab_lich_su&quot;&gt;Lịch sử&lt;/string&gt;&#10;    &lt;string name=&quot;tab_dia_li&quot;&gt;Địa lí&lt;/string&gt;&#10;    &lt;string name=&quot;tab_hoa_hoc&quot;&gt;Hóa học&lt;/string&gt;&#10;    &lt;string name=&quot;sample_question&quot;&gt;What is english ?&lt;/string&gt;&#10;    &lt;string name=&quot;muc_do_de_label&quot;&gt;Mức độ - Dễ&lt;/string&gt;&#10;    &lt;string name=&quot;cd_delete_icon&quot;&gt;Xóa câu hỏi&lt;/string&gt;&#10;    &lt;string name=&quot;num_questions_format&quot;&gt;Số câu: %d&lt;/string&gt;&#10;    &lt;string name=&quot;duration_format&quot;&gt;%d Phút&lt;/string&gt;&#10;&lt;/resources&gt;" />
            </PendingDiffInfo>
          </value>
        </entry>
      </map>
    </option>
  </component>
</project>